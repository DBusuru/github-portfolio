var rrweb=function(G){"use strict";var T;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(T||(T={}));function jt(t){return t.nodeType===t.ELEMENT_NODE}function Fe(t){const e=t?.host;return Boolean(e?.shadowRoot===t)}function Pe(t){return Object.prototype.toString.call(t)==="[object ShadowRoot]"}function gr(t){return t.includes(" background-clip: text;")&&!t.includes(" -webkit-background-clip: text;")&&(t=t.replace(" background-clip: text;"," -webkit-background-clip: text; background-clip: text;")),t}function vr(t){const{cssText:e}=t;if(e.split('"').length<3)return e;const n=["@import",`url(${JSON.stringify(t.href)})`];return t.layerName===""?n.push("layer"):t.layerName&&n.push(`layer(${t.layerName})`),t.supportsText&&n.push(`supports(${t.supportsText})`),t.media.length&&n.push(t.media.mediaText),n.join(" ")+";"}function Ge(t){try{const e=t.rules||t.cssRules;return e?gr(Array.from(e,zt).join("")):null}catch{return null}}function zt(t){let e;if(br(t))try{e=Ge(t.styleSheet)||vr(t)}catch{}else if(wr(t)&&t.selectorText.includes(":"))return Sr(t.cssText);return e||t.cssText}function Sr(t){const e=/(\[(?:[\w-]+)[^\\])(:(?:[\w-]+)\])/gm;return t.replace(e,"$1\\$2")}function br(t){return"styleSheet"in t}function wr(t){return"selectorText"in t}class ut{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var n;if(!e)return-1;const r=(n=this.getMeta(e))===null||n===void 0?void 0:n.id;return r??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){const r=n.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,n)}replace(e,n){const r=this.getNode(e);if(r){const o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function Ht(){return new ut}function dt({element:t,maskInputOptions:e,tagName:n,type:r,value:o,maskInputFn:a}){let i=o||"";const s=r&&he(r);return(e[n.toLowerCase()]||s&&e[s])&&(a?i=a(i,t):i="*".repeat(i.length)),i}function he(t){return t.toLowerCase()}const Gt="__rrweb_original__";function Mr(t){const e=t.getContext("2d");if(!e)return!0;const n=50;for(let r=0;r<t.width;r+=n)for(let o=0;o<t.height;o+=n){const a=e.getImageData,i=Gt in a?a[Gt]:a;if(new Uint32Array(i.call(e,r,o,Math.min(n,t.width-r),Math.min(n,t.height-o)).data.buffer).some(s=>s!==0))return!1}return!0}function Er(t,e){return!t||!e||t.type!==e.type?!1:t.type===T.Document?t.compatMode===e.compatMode:t.type===T.DocumentType?t.name===e.name&&t.publicId===e.publicId&&t.systemId===e.systemId:t.type===T.Comment||t.type===T.Text||t.type===T.CDATA?t.textContent===e.textContent:t.type===T.Element?t.tagName===e.tagName&&JSON.stringify(t.attributes)===JSON.stringify(e.attributes)&&t.isSVG===e.isSVG&&t.needBlock===e.needBlock:!1}function ht(t){const e=t.type;return t.hasAttribute("data-rr-is-password")?"password":e?he(e):null}function Yt(t,e){var n;let r;try{r=new URL(t,e??window.location.href)}catch{return null}const o=/\.([0-9a-z]+)(?:$)/i,a=r.pathname.match(o);return(n=a?.[1])!==null&&n!==void 0?n:null}let Cr=1;const Tr=new RegExp("[^a-z0-9-_:]"),$e=-2;function Xt(){return Cr++}function Ir(t){if(t instanceof HTMLFormElement)return"form";const e=he(t.tagName);return Tr.test(e)?"div":e}function Nr(t){let e="";return t.indexOf("//")>-1?e=t.split("/").slice(0,3).join("/"):e=t.split("/")[0],e=e.split("?")[0],e}let Ce,qt;const Dr=/url\((?:(')([^']*)'|(")(.*?)"|([^)]*))\)/gm,kr=/^(?:[a-z+]+:)?\/\//i,Rr=/^www\..*/i,Or=/^(data:)([^,]*),(.*)/i;function Ye(t,e){return(t||"").replace(Dr,(n,r,o,a,i,s)=>{const l=o||i||s,c=r||a||"";if(!l)return n;if(kr.test(l)||Rr.test(l))return`url(${c}${l}${c})`;if(Or.test(l))return`url(${c}${l}${c})`;if(l[0]==="/")return`url(${c}${Nr(e)+l}${c})`;const u=e.split("/"),d=l.split("/");u.pop();for(const h of d)h!=="."&&(h===".."?u.pop():u.push(h));return`url(${c}${u.join("/")}${c})`})}const xr=/^[^ \t\n\r\u000c]+/,Ar=/^[, \t\n\r\u000c]+/;function Lr(t,e){if(e.trim()==="")return e;let n=0;function r(a){let i;const s=a.exec(e.substring(n));return s?(i=s[0],n+=i.length,i):""}const o=[];for(;r(Ar),!(n>=e.length);){let a=r(xr);if(a.slice(-1)===",")a=Xe(t,a.substring(0,a.length-1)),o.push(a);else{let i="";a=Xe(t,a);let s=!1;for(;;){const l=e.charAt(n);if(l===""){o.push((a+i).trim());break}else if(s)l===")"&&(s=!1);else if(l===","){n+=1,o.push((a+i).trim());break}else l==="("&&(s=!0);i+=l,n+=1}}}return o.join(", ")}function Xe(t,e){if(!e||e.trim()==="")return e;const n=t.createElement("a");return n.href=e,n.href}function _r(t){return Boolean(t.tagName==="svg"||t.ownerSVGElement)}function pt(){const t=document.createElement("a");return t.href="",t.href}function Qt(t,e,n,r){return r&&(n==="src"||n==="href"&&!(e==="use"&&r[0]==="#")||n==="xlink:href"&&r[0]!=="#"||n==="background"&&(e==="table"||e==="td"||e==="th")?Xe(t,r):n==="srcset"?Lr(t,r):n==="style"?Ye(r,pt()):e==="object"&&n==="data"?Xe(t,r):r)}function Jt(t,e,n){return(t==="video"||t==="audio")&&e==="autoplay"}function Fr(t,e,n){try{if(typeof e=="string"){if(t.classList.contains(e))return!0}else for(let r=t.classList.length;r--;){const o=t.classList[r];if(e.test(o))return!0}if(n)return t.matches(n)}catch{}return!1}function qe(t,e,n){if(!t)return!1;if(t.nodeType!==t.ELEMENT_NODE)return n?qe(t.parentNode,e,n):!1;for(let r=t.classList.length;r--;){const o=t.classList[r];if(e.test(o))return!0}return n?qe(t.parentNode,e,n):!1}function Kt(t,e,n,r){try{const o=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(o===null)return!1;if(typeof e=="string"){if(r){if(o.closest(`.${e}`))return!0}else if(o.classList.contains(e))return!0}else if(qe(o,e,r))return!0;if(n){if(r){if(o.closest(n))return!0}else if(o.matches(n))return!0}}catch{}return!1}function Pr(t,e,n){const r=t.contentWindow;if(!r)return;let o=!1,a;try{a=r.document.readyState}catch{return}if(a!=="complete"){const s=setTimeout(()=>{o||(e(),o=!0)},n);t.addEventListener("load",()=>{clearTimeout(s),o=!0,e()});return}const i="about:blank";if(r.location.href!==i||t.src===i||t.src==="")return setTimeout(e,0),t.addEventListener("load",e);t.addEventListener("load",e)}function $r(t,e,n){let r=!1,o;try{o=t.sheet}catch{return}if(o)return;const a=setTimeout(()=>{r||(e(),r=!0)},n);t.addEventListener("load",()=>{clearTimeout(a),r=!0,e()})}function Ur(t,e){const{doc:n,mirror:r,blockClass:o,blockSelector:a,needsMask:i,inlineStylesheet:s,maskInputOptions:l={},maskTextFn:c,maskInputFn:u,dataURLOptions:d={},inlineImages:h,recordCanvas:m,keepIframeSrcFn:y,newlyAddedElement:p=!1}=e,v=Wr(n,r);switch(t.nodeType){case t.DOCUMENT_NODE:return t.compatMode!=="CSS1Compat"?{type:T.Document,childNodes:[],compatMode:t.compatMode}:{type:T.Document,childNodes:[]};case t.DOCUMENT_TYPE_NODE:return{type:T.DocumentType,name:t.name,publicId:t.publicId,systemId:t.systemId,rootId:v};case t.ELEMENT_NODE:return Vr(t,{doc:n,blockClass:o,blockSelector:a,inlineStylesheet:s,maskInputOptions:l,maskInputFn:u,dataURLOptions:d,inlineImages:h,recordCanvas:m,keepIframeSrcFn:y,newlyAddedElement:p,rootId:v});case t.TEXT_NODE:return Br(t,{needsMask:i,maskTextFn:c,rootId:v});case t.CDATA_SECTION_NODE:return{type:T.CDATA,textContent:"",rootId:v};case t.COMMENT_NODE:return{type:T.Comment,textContent:t.textContent||"",rootId:v};default:return!1}}function Wr(t,e){if(!e.hasNode(t))return;const n=e.getId(t);return n===1?void 0:n}function Br(t,e){var n;const{needsMask:r,maskTextFn:o,rootId:a}=e,i=t.parentNode&&t.parentNode.tagName;let s=t.textContent;const l=i==="STYLE"?!0:void 0,c=i==="SCRIPT"?!0:void 0;if(l&&s){try{t.nextSibling||t.previousSibling||!((n=t.parentNode.sheet)===null||n===void 0)&&n.cssRules&&(s=Ge(t.parentNode.sheet))}catch(u){console.warn(`Cannot get CSS styles from text's parentNode. Error: ${u}`,t)}s=Ye(s,pt())}return c&&(s="SCRIPT_PLACEHOLDER"),!l&&!c&&s&&r&&(s=o?o(s,t.parentElement):s.replace(/[\S]/g,"*")),{type:T.Text,textContent:s||"",isStyle:l,rootId:a}}function Vr(t,e){const{doc:n,blockClass:r,blockSelector:o,inlineStylesheet:a,maskInputOptions:i={},maskInputFn:s,dataURLOptions:l={},inlineImages:c,recordCanvas:u,keepIframeSrcFn:d,newlyAddedElement:h=!1,rootId:m}=e,y=Fr(t,r,o),p=Ir(t);let v={};const f=t.attributes.length;for(let g=0;g<f;g++){const w=t.attributes[g];Jt(p,w.name,w.value)||(v[w.name]=Qt(n,p,he(w.name),w.value))}if(p==="link"&&a){const g=Array.from(n.styleSheets).find(I=>I.href===t.href);let w=null;g&&(w=Ge(g)),w&&(delete v.rel,delete v.href,v._cssText=Ye(w,g.href))}if(p==="style"&&t.sheet&&!(t.innerText||t.textContent||"").trim().length){const g=Ge(t.sheet);g&&(v._cssText=Ye(g,pt()))}if(p==="input"||p==="textarea"||p==="select"){const g=t.value,w=t.checked;v.type!=="radio"&&v.type!=="checkbox"&&v.type!=="submit"&&v.type!=="button"&&g?v.value=dt({element:t,type:ht(t),tagName:p,value:g,maskInputOptions:i,maskInputFn:s}):w&&(v.checked=w)}if(p==="option"&&(t.selected&&!i.select?v.selected=!0:delete v.selected),p==="canvas"&&u){if(t.__context==="2d")Mr(t)||(v.rr_dataURL=t.toDataURL(l.type,l.quality));else if(!("__context"in t)){const g=t.toDataURL(l.type,l.quality),w=document.createElement("canvas");w.width=t.width,w.height=t.height;const I=w.toDataURL(l.type,l.quality);g!==I&&(v.rr_dataURL=g)}}if(p==="img"&&c){Ce||(Ce=n.createElement("canvas"),qt=Ce.getContext("2d"));const g=t,w=g.crossOrigin;g.crossOrigin="anonymous";const I=()=>{g.removeEventListener("load",I);try{Ce.width=g.naturalWidth,Ce.height=g.naturalHeight,qt.drawImage(g,0,0),v.rr_dataURL=Ce.toDataURL(l.type,l.quality)}catch(L){console.warn(`Cannot inline img src=${g.currentSrc}! Error: ${L}`)}w?v.crossOrigin=w:g.removeAttribute("crossorigin")};g.complete&&g.naturalWidth!==0?I():g.addEventListener("load",I)}if(p==="audio"||p==="video"){const g=v;g.rr_mediaState=t.paused?"paused":"played",g.rr_mediaCurrentTime=t.currentTime,g.rr_mediaPlaybackRate=t.playbackRate,g.rr_mediaMuted=t.muted,g.rr_mediaLoop=t.loop,g.rr_mediaVolume=t.volume}if(h||(t.scrollLeft&&(v.rr_scrollLeft=t.scrollLeft),t.scrollTop&&(v.rr_scrollTop=t.scrollTop)),y){const{width:g,height:w}=t.getBoundingClientRect();v={class:v.class,rr_width:`${g}px`,rr_height:`${w}px`}}p==="iframe"&&!d(v.src)&&(t.contentDocument||(v.rr_src=v.src),delete v.src);let S;try{customElements.get(p)&&(S=!0)}catch{}return{type:T.Element,tagName:p,attributes:v,childNodes:[],isSVG:_r(t)||void 0,needBlock:y,rootId:m,isCustom:S}}function _(t){return t==null?"":t.toLowerCase()}function jr(t,e){return!!(e.comment&&t.type===T.Comment||t.type===T.Element&&(e.script&&(t.tagName==="script"||t.tagName==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||t.tagName==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&Yt(t.attributes.href)==="js")||e.headFavicon&&(t.tagName==="link"&&t.attributes.rel==="shortcut icon"||t.tagName==="meta"&&(_(t.attributes.name).match(/^msapplication-tile(image|color)$/)||_(t.attributes.name)==="application-name"||_(t.attributes.rel)==="icon"||_(t.attributes.rel)==="apple-touch-icon"||_(t.attributes.rel)==="shortcut icon"))||t.tagName==="meta"&&(e.headMetaDescKeywords&&_(t.attributes.name).match(/^description|keywords$/)||e.headMetaSocial&&(_(t.attributes.property).match(/^(og|twitter|fb):/)||_(t.attributes.name).match(/^(og|twitter):/)||_(t.attributes.name)==="pinterest")||e.headMetaRobots&&(_(t.attributes.name)==="robots"||_(t.attributes.name)==="googlebot"||_(t.attributes.name)==="bingbot")||e.headMetaHttpEquiv&&t.attributes["http-equiv"]!==void 0||e.headMetaAuthorship&&(_(t.attributes.name)==="author"||_(t.attributes.name)==="generator"||_(t.attributes.name)==="framework"||_(t.attributes.name)==="publisher"||_(t.attributes.name)==="progid"||_(t.attributes.property).match(/^article:/)||_(t.attributes.property).match(/^product:/))||e.headMetaVerification&&(_(t.attributes.name)==="google-site-verification"||_(t.attributes.name)==="yandex-verification"||_(t.attributes.name)==="csrf-token"||_(t.attributes.name)==="p:domain_verify"||_(t.attributes.name)==="verify-v1"||_(t.attributes.name)==="verification"||_(t.attributes.name)==="shopify-checkout-api-token"))))}function Te(t,e){const{doc:n,mirror:r,blockClass:o,blockSelector:a,maskTextClass:i,maskTextSelector:s,skipChild:l=!1,inlineStylesheet:c=!0,maskInputOptions:u={},maskTextFn:d,maskInputFn:h,slimDOMOptions:m,dataURLOptions:y={},inlineImages:p=!1,recordCanvas:v=!1,onSerialize:f,onIframeLoad:S,iframeLoadTimeout:g=5e3,onStylesheetLoad:w,stylesheetLoadTimeout:I=5e3,keepIframeSrcFn:L=()=>!1,newlyAddedElement:j=!1}=e;let{needsMask:z}=e,{preserveWhiteSpace:Q=!0}=e;!z&&t.childNodes&&(z=Kt(t,i,s,z===void 0));const J=Ur(t,{doc:n,mirror:r,blockClass:o,blockSelector:a,needsMask:z,inlineStylesheet:c,maskInputOptions:u,maskTextFn:d,maskInputFn:h,dataURLOptions:y,inlineImages:p,recordCanvas:v,keepIframeSrcFn:L,newlyAddedElement:j});if(!J)return console.warn(t,"not serialized"),null;let re;r.hasNode(t)?re=r.getId(t):jr(J,m)||!Q&&J.type===T.Text&&!J.isStyle&&!J.textContent.replace(/^\s+|\s+$/gm,"").length?re=$e:re=Xt();const R=Object.assign(J,{id:re});if(r.add(t,R),re===$e)return null;f&&f(t);let oe=!l;if(R.type===T.Element){oe=oe&&!R.needBlock,delete R.needBlock;const H=t.shadowRoot;H&&Pe(H)&&(R.isShadowHost=!0)}if((R.type===T.Document||R.type===T.Element)&&oe){m.headWhitespace&&R.type===T.Element&&R.tagName==="head"&&(Q=!1);const H={doc:n,mirror:r,blockClass:o,blockSelector:a,needsMask:z,maskTextClass:i,maskTextSelector:s,skipChild:l,inlineStylesheet:c,maskInputOptions:u,maskTextFn:d,maskInputFn:h,slimDOMOptions:m,dataURLOptions:y,inlineImages:p,recordCanvas:v,preserveWhiteSpace:Q,onSerialize:f,onIframeLoad:S,iframeLoadTimeout:g,onStylesheetLoad:w,stylesheetLoadTimeout:I,keepIframeSrcFn:L};if(!(R.type===T.Element&&R.tagName==="textarea"&&R.attributes.value!==void 0))for(const se of Array.from(t.childNodes)){const K=Te(se,H);K&&R.childNodes.push(K)}if(jt(t)&&t.shadowRoot)for(const se of Array.from(t.shadowRoot.childNodes)){const K=Te(se,H);K&&(Pe(t.shadowRoot)&&(K.isShadow=!0),R.childNodes.push(K))}}return t.parentNode&&Fe(t.parentNode)&&Pe(t.parentNode)&&(R.isShadow=!0),R.type===T.Element&&R.tagName==="iframe"&&Pr(t,()=>{const H=t.contentDocument;if(H&&S){const se=Te(H,{doc:H,mirror:r,blockClass:o,blockSelector:a,needsMask:z,maskTextClass:i,maskTextSelector:s,skipChild:!1,inlineStylesheet:c,maskInputOptions:u,maskTextFn:d,maskInputFn:h,slimDOMOptions:m,dataURLOptions:y,inlineImages:p,recordCanvas:v,preserveWhiteSpace:Q,onSerialize:f,onIframeLoad:S,iframeLoadTimeout:g,onStylesheetLoad:w,stylesheetLoadTimeout:I,keepIframeSrcFn:L});se&&S(t,se)}},g),R.type===T.Element&&R.tagName==="link"&&typeof R.attributes.rel=="string"&&(R.attributes.rel==="stylesheet"||R.attributes.rel==="preload"&&typeof R.attributes.href=="string"&&Yt(R.attributes.href)==="css")&&$r(t,()=>{if(w){const H=Te(t,{doc:n,mirror:r,blockClass:o,blockSelector:a,needsMask:z,maskTextClass:i,maskTextSelector:s,skipChild:!1,inlineStylesheet:c,maskInputOptions:u,maskTextFn:d,maskInputFn:h,slimDOMOptions:m,dataURLOptions:y,inlineImages:p,recordCanvas:v,preserveWhiteSpace:Q,onSerialize:f,onIframeLoad:S,iframeLoadTimeout:g,onStylesheetLoad:w,stylesheetLoadTimeout:I,keepIframeSrcFn:L});H&&w(t,H)}},I),R}function zr(t,e){const{mirror:n=new ut,blockClass:r="rr-block",blockSelector:o=null,maskTextClass:a="rr-mask",maskTextSelector:i=null,inlineStylesheet:s=!0,inlineImages:l=!1,recordCanvas:c=!1,maskAllInputs:u=!1,maskTextFn:d,maskInputFn:h,slimDOM:m=!1,dataURLOptions:y,preserveWhiteSpace:p,onSerialize:v,onIframeLoad:f,iframeLoadTimeout:S,onStylesheetLoad:g,stylesheetLoadTimeout:w,keepIframeSrcFn:I=()=>!1}=e||{};return Te(t,{doc:t,mirror:n,blockClass:r,blockSelector:o,maskTextClass:a,maskTextSelector:i,skipChild:!1,inlineStylesheet:s,maskInputOptions:u===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:u===!1?{password:!0}:u,maskTextFn:d,maskInputFn:h,slimDOMOptions:m===!0||m==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaDescKeywords:m==="all",headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaAuthorship:!0,headMetaVerification:!0}:m===!1?{}:m,dataURLOptions:y,inlineImages:l,recordCanvas:c,preserveWhiteSpace:p,onSerialize:v,onIframeLoad:f,iframeLoadTimeout:S,onStylesheetLoad:g,stylesheetLoadTimeout:w,keepIframeSrcFn:I,newlyAddedElement:!1})}const Zt=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g;function Hr(t,e={}){let n=1,r=1;function o(M){const b=M.match(/\n/g);b&&(n+=b.length);const N=M.lastIndexOf(`
`);r=N===-1?r+M.length:M.length-N}function a(){const M={line:n,column:r};return b=>(b.position=new i(M),y(),b)}class i{constructor(b){this.start=b,this.end={line:n,column:r},this.source=e.source}}i.prototype.content=t;const s=[];function l(M){const b=new Error(`${e.source||""}:${n}:${r}: ${M}`);if(b.reason=M,b.filename=e.source,b.line=n,b.column=r,b.source=t,e.silent)s.push(b);else throw b}function c(){const M=h();return{type:"stylesheet",stylesheet:{source:e.source,rules:M,parsingErrors:s}}}function u(){return m(/^{\s*/)}function d(){return m(/^}/)}function h(){let M;const b=[];for(y(),p(b);t.length&&t.charAt(0)!=="}"&&(M=de()||ve());)M&&(b.push(M),p(b));return b}function m(M){const b=M.exec(t);if(!b)return;const N=b[0];return o(N),t=t.slice(N.length),b}function y(){m(/^\s*/)}function p(M=[]){let b;for(;b=v();)b&&M.push(b),b=v();return M}function v(){const M=a();if(t.charAt(0)!=="/"||t.charAt(1)!=="*")return;let b=2;for(;t.charAt(b)!==""&&(t.charAt(b)!=="*"||t.charAt(b+1)!=="/");)++b;if(b+=2,t.charAt(b-1)==="")return l("End of comment missing");const N=t.slice(2,b-2);return r+=2,o(N),t=t.slice(b),r+=2,M({type:"comment",comment:N})}function f(){for(y();t[0]=="}";)l("extra closing bracket"),t=t.slice(1),y();const M=m(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(!M)return;const b=M[0].trim().replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,"").replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,N=>N.replace(/,/g,"\u200C"));return S(b).map(N=>N.replace(/\u200C/g,",").trim())}function S(M){const b=[];let N="",P=0,q=0;for(const te of M)te==="("?P++:te===")"?P--:te==="["?q++:te==="]"&&q--,te===","&&P===0&&q===0?(b.push(N),N=""):N+=te;return N&&b.push(N),b}function g(){const M=a(),b=m(/^(\*?[-#\/\*\\\w]+(\[[0-9a-z_-]+\])?)\s*/);if(!b)return;const N=pe(b[0]);if(!m(/^:\s*/))return l("property missing ':'");const P=m(/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^\)]*?\)|[^};])+)/),q=M({type:"declaration",property:N.replace(Zt,""),value:P?pe(P[0]).replace(Zt,""):""});return m(/^[;\s]*/),q}function w(){const M=[];if(!u())return l("missing '{'");p(M);let b;for(;b=g();)b!==!1&&(M.push(b),p(M)),b=g();return d()?M:l("missing '}'")}function I(){let M;const b=[],N=a();for(;M=m(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)b.push(M[1]),m(/^,\s*/);if(b.length)return N({type:"keyframe",values:b,declarations:w()})}function L(){const M=a();let b=m(/^@([-\w]+)?keyframes\s*/);if(!b)return;const N=b[1];if(b=m(/^([-\w]+)\s*/),!b)return l("@keyframes missing name");const P=b[1];if(!u())return l("@keyframes missing '{'");let q,te=p();for(;q=I();)te.push(q),te=te.concat(p());return d()?M({type:"keyframes",name:P,vendor:N,keyframes:te}):l("@keyframes missing '}'")}function j(){const M=a(),b=m(/^@supports *([^{]+)/);if(!b)return;const N=pe(b[1]);if(!u())return l("@supports missing '{'");const P=p().concat(h());return d()?M({type:"supports",supports:N,rules:P}):l("@supports missing '}'")}function z(){const M=a();if(!m(/^@host\s*/))return;if(!u())return l("@host missing '{'");const b=p().concat(h());return d()?M({type:"host",rules:b}):l("@host missing '}'")}function Q(){const M=a(),b=m(/^@media *([^{]+)/);if(!b)return;const N=pe(b[1]);if(!u())return l("@media missing '{'");const P=p().concat(h());return d()?M({type:"media",media:N,rules:P}):l("@media missing '}'")}function J(){const M=a(),b=m(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(b)return M({type:"custom-media",name:pe(b[1]),media:pe(b[2])})}function re(){const M=a();if(!m(/^@page */))return;const b=f()||[];if(!u())return l("@page missing '{'");let N=p(),P;for(;P=g();)N.push(P),N=N.concat(p());return d()?M({type:"page",selectors:b,declarations:N}):l("@page missing '}'")}function R(){const M=a(),b=m(/^@([-\w]+)?document *([^{]+)/);if(!b)return;const N=pe(b[1]),P=pe(b[2]);if(!u())return l("@document missing '{'");const q=p().concat(h());return d()?M({type:"document",document:P,vendor:N,rules:q}):l("@document missing '}'")}function oe(){const M=a();if(!m(/^@font-face\s*/))return;if(!u())return l("@font-face missing '{'");let b=p(),N;for(;N=g();)b.push(N),b=b.concat(p());return d()?M({type:"font-face",declarations:b}):l("@font-face missing '}'")}const H=F("import"),se=F("charset"),K=F("namespace");function F(M){const b=new RegExp("^@"+M+"\\s*([^;]+);");return()=>{const N=a(),P=m(b);if(!P)return;const q={type:M};return q[M]=P[1].trim(),N(q)}}function de(){if(t[0]==="@")return L()||Q()||J()||j()||H()||se()||K()||R()||re()||z()||oe()}function ve(){const M=a(),b=f();return b?(p(),M({type:"rule",selectors:b,declarations:w()})):l("selector missing")}return mt(c())}function pe(t){return t?t.replace(/^\s+|\s+$/g,""):""}function mt(t,e){const n=t&&typeof t.type=="string",r=n?t:e;for(const o of Object.keys(t)){const a=t[o];Array.isArray(a)?a.forEach(i=>{mt(i,r)}):a&&typeof a=="object"&&mt(a,r)}return n&&Object.defineProperty(t,"parent",{configurable:!0,writable:!0,enumerable:!1,value:e||null}),t}const en={script:"noscript",altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};function Gr(t){let e=en[t.tagName]?en[t.tagName]:t.tagName;return e==="link"&&t.attributes._cssText&&(e="style"),e}function tn(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}const nn=/(max|min)-device-(width|height)/,Yr=new RegExp(nn.source,"g"),rn=/([^\\]):hover/,Xr=new RegExp(rn.source,"g");function on(t,e){const n=e?.stylesWithHoverClass.get(t);if(n)return n;const r=Hr(t,{silent:!0});if(!r.stylesheet)return t;const o=[],a=[];function i(l){"selectors"in l&&l.selectors&&l.selectors.forEach(c=>{rn.test(c)&&o.push(c)}),"media"in l&&l.media&&nn.test(l.media)&&a.push(l.media),"rules"in l&&l.rules&&l.rules.forEach(i)}i(r.stylesheet);let s=t;if(o.length>0){const l=new RegExp(o.filter((c,u)=>o.indexOf(c)===u).sort((c,u)=>u.length-c.length).map(c=>tn(c)).join("|"),"g");s=s.replace(l,c=>{const u=c.replace(Xr,"$1.\\:hover");return`${c}, ${u}`})}if(a.length>0){const l=new RegExp(a.filter((c,u)=>a.indexOf(c)===u).sort((c,u)=>u.length-c.length).map(c=>tn(c)).join("|"),"g");s=s.replace(l,c=>c.replace(Yr,"$1-$2"))}return e?.stylesWithHoverClass.set(t,s),s}function sn(){return{stylesWithHoverClass:new Map}}function qr(t,e){var n;const{doc:r,hackCss:o,cache:a}=e;switch(t.type){case T.Document:return r.implementation.createDocument(null,"",null);case T.DocumentType:return r.implementation.createDocumentType(t.name||"html",t.publicId,t.systemId);case T.Element:{const i=Gr(t);let s;t.isSVG?s=r.createElementNS("http://www.w3.org/2000/svg",i):(t.isCustom&&((n=r.defaultView)===null||n===void 0?void 0:n.customElements)&&!r.defaultView.customElements.get(t.tagName)&&r.defaultView.customElements.define(t.tagName,class extends r.defaultView.HTMLElement{}),s=r.createElement(i));const l={};for(const c in t.attributes){if(!Object.prototype.hasOwnProperty.call(t.attributes,c))continue;let u=t.attributes[c];if(i==="option"&&c==="selected"&&u===!1||u===null)continue;if(u===!0&&(u=""),c.startsWith("rr_")){l[c]=u;continue}const d=i==="textarea"&&c==="value",h=i==="style"&&c==="_cssText";if(h&&o&&typeof u=="string"&&(u=on(u,a)),(d||h)&&typeof u=="string"){s.appendChild(r.createTextNode(u)),t.childNodes=[];continue}try{if(t.isSVG&&c==="xlink:href")s.setAttributeNS("http://www.w3.org/1999/xlink",c,u.toString());else if(c==="onload"||c==="onclick"||c.substring(0,7)==="onmouse")s.setAttribute("_"+c,u.toString());else if(i==="meta"&&t.attributes["http-equiv"]==="Content-Security-Policy"&&c==="content"){s.setAttribute("csp-content",u.toString());continue}else i==="link"&&(t.attributes.rel==="preload"||t.attributes.rel==="modulepreload")&&t.attributes.as==="script"||i==="link"&&t.attributes.rel==="prefetch"&&typeof t.attributes.href=="string"&&t.attributes.href.endsWith(".js")||(i==="img"&&t.attributes.srcset&&t.attributes.rr_dataURL?s.setAttribute("rrweb-original-srcset",t.attributes.srcset):s.setAttribute(c,u.toString()))}catch{}}for(const c in l){const u=l[c];if(i==="canvas"&&c==="rr_dataURL"){const d=document.createElement("img");d.onload=()=>{const h=s.getContext("2d");h&&h.drawImage(d,0,0,d.width,d.height)},d.src=u.toString(),s.RRNodeType&&(s.rr_dataURL=u.toString())}else if(i==="img"&&c==="rr_dataURL"){const d=s;d.currentSrc.startsWith("data:")||(d.setAttribute("rrweb-original-src",t.attributes.src),d.src=u.toString())}if(c==="rr_width")s.style.width=u.toString();else if(c==="rr_height")s.style.height=u.toString();else if(c==="rr_mediaCurrentTime"&&typeof u=="number")s.currentTime=u;else if(c==="rr_mediaState")switch(u){case"played":s.play().catch(d=>console.warn("media playback error",d));break;case"paused":s.pause();break}else c==="rr_mediaPlaybackRate"&&typeof u=="number"?s.playbackRate=u:c==="rr_mediaMuted"&&typeof u=="boolean"?s.muted=u:c==="rr_mediaLoop"&&typeof u=="boolean"?s.loop=u:c==="rr_mediaVolume"&&typeof u=="number"&&(s.volume=u)}if(t.isShadowHost)if(!s.shadowRoot)s.attachShadow({mode:"open"});else for(;s.shadowRoot.firstChild;)s.shadowRoot.removeChild(s.shadowRoot.firstChild);return s}case T.Text:return r.createTextNode(t.isStyle&&o?on(t.textContent,a):t.textContent);case T.CDATA:return r.createCDATASection(t.textContent);case T.Comment:return r.createComment(t.textContent);default:return null}}function Ue(t,e){const{doc:n,mirror:r,skipChild:o=!1,hackCss:a=!0,afterAppend:i,cache:s}=e;if(r.has(t.id)){const c=r.getNode(t.id),u=r.getMeta(c);if(Er(u,t))return r.getNode(t.id)}let l=qr(t,{doc:n,hackCss:a,cache:s});if(!l)return null;if(t.rootId&&r.getNode(t.rootId)!==n&&r.replace(t.rootId,n),t.type===T.Document&&(n.close(),n.open(),t.compatMode==="BackCompat"&&t.childNodes&&t.childNodes[0].type!==T.DocumentType&&(t.childNodes[0].type===T.Element&&"xmlns"in t.childNodes[0].attributes&&t.childNodes[0].attributes.xmlns==="http://www.w3.org/1999/xhtml"?n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'):n.write('<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">')),l=n),r.add(l,t),(t.type===T.Document||t.type===T.Element)&&!o)for(const c of t.childNodes){const u=Ue(c,{doc:n,mirror:r,skipChild:!1,hackCss:a,afterAppend:i,cache:s});if(!u){console.warn("Failed to rebuild",c);continue}if(c.isShadow&&jt(l)&&l.shadowRoot)l.shadowRoot.appendChild(u);else if(t.type===T.Document&&c.type==T.Element){const d=u;let h=null;d.childNodes.forEach(m=>{m.nodeName==="BODY"&&(h=m)}),h?(d.removeChild(h),l.appendChild(u),d.appendChild(h)):l.appendChild(u)}else l.appendChild(u);i&&i(u,c.id)}return l}function Qr(t,e){function n(r){e(r)}for(const r of t.getIds())t.has(r)&&n(t.getNode(r))}function Jr(t,e){const n=e.getMeta(t);if(n?.type!==T.Element)return;const r=t;for(const o in n.attributes){if(!(Object.prototype.hasOwnProperty.call(n.attributes,o)&&o.startsWith("rr_")))continue;const a=n.attributes[o];o==="rr_scrollLeft"&&(r.scrollLeft=a),o==="rr_scrollTop"&&(r.scrollTop=a)}}function Kr(t,e){const{doc:n,onVisit:r,hackCss:o=!0,afterAppend:a,cache:i,mirror:s=new ut}=e,l=Ue(t,{doc:n,mirror:s,skipChild:!1,hackCss:o,afterAppend:a,cache:i});return Qr(s,c=>{r&&r(c),Jr(c,s)}),l}function Y(t,e,n=document){const r={capture:!0,passive:!0};return n.addEventListener(t,e,r),()=>n.removeEventListener(t,e,r)}const Ie=`Please stop import mirror directly. Instead of that,\r
now you can use replayer.getMirror() to access the mirror instance of a replayer,\r
or you can use record.mirror to access the mirror instance during recording.`;G.mirror={map:{},getId(){return console.error(Ie),-1},getNode(){return console.error(Ie),null},removeNodeFromMap(){console.error(Ie)},has(){return console.error(Ie),!1},reset(){console.error(Ie)}},typeof window<"u"&&window.Proxy&&window.Reflect&&(G.mirror=new Proxy(G.mirror,{get(t,e,n){return e==="map"&&console.error(Ie),Reflect.get(t,e,n)}}));function Ne(t,e,n={}){let r=null,o=0;return function(...a){const i=Date.now();!o&&n.leading===!1&&(o=i);const s=e-(i-o),l=this;s<=0||s>e?(r&&(clearTimeout(r),r=null),o=i,t.apply(l,a)):!r&&n.trailing!==!1&&(r=setTimeout(()=>{o=n.leading===!1?0:Date.now(),r=null,t.apply(l,a)},s))}}function We(t,e,n,r,o=window){const a=o.Object.getOwnPropertyDescriptor(t,e);return o.Object.defineProperty(t,e,r?n:{set(i){setTimeout(()=>{n.set.call(this,i)},0),a&&a.set&&a.set.call(this,i)}}),()=>We(t,e,a||{},!0)}function Se(t,e,n){try{if(!(e in t))return()=>{};const r=t[e],o=n(r);return typeof o=="function"&&(o.prototype=o.prototype||{},Object.defineProperties(o,{__rrweb_original__:{enumerable:!1,value:r}})),t[e]=o,()=>{t[e]=r}}catch{return()=>{}}}let Be=Date.now;/[1-9][0-9]{12}/.test(Date.now().toString())||(Be=()=>new Date().getTime());function ft(t){var e,n,r,o,a,i;const s=t.document;return{left:s.scrollingElement?s.scrollingElement.scrollLeft:t.pageXOffset!==void 0?t.pageXOffset:s?.documentElement.scrollLeft||((n=(e=s?.body)==null?void 0:e.parentElement)==null?void 0:n.scrollLeft)||((r=s?.body)==null?void 0:r.scrollLeft)||0,top:s.scrollingElement?s.scrollingElement.scrollTop:t.pageYOffset!==void 0?t.pageYOffset:s?.documentElement.scrollTop||((a=(o=s?.body)==null?void 0:o.parentElement)==null?void 0:a.scrollTop)||((i=s?.body)==null?void 0:i.scrollTop)||0}}function yt(){return window.innerHeight||document.documentElement&&document.documentElement.clientHeight||document.body&&document.body.clientHeight}function gt(){return window.innerWidth||document.documentElement&&document.documentElement.clientWidth||document.body&&document.body.clientWidth}function vt(t){return t?t.nodeType===t.ELEMENT_NODE?t:t.parentElement:null}function X(t,e,n,r){if(!t)return!1;const o=vt(t);if(!o)return!1;try{if(typeof e=="string"){if(o.classList.contains(e)||r&&o.closest("."+e)!==null)return!0}else if(qe(o,e,r))return!0}catch{}return!!(n&&(o.matches(n)||r&&o.closest(n)!==null))}function an(t,e){return e.getId(t)!==-1}function Qe(t,e){return e.getId(t)===$e}function St(t,e){if(Fe(t))return!1;const n=e.getId(t);return e.has(n)?t.parentNode&&t.parentNode.nodeType===t.DOCUMENT_NODE?!1:t.parentNode?St(t.parentNode,e):!0:!0}function Je(t){return Boolean(t.changedTouches)}function bt(t=window){"NodeList"in t&&!t.NodeList.prototype.forEach&&(t.NodeList.prototype.forEach=Array.prototype.forEach),"DOMTokenList"in t&&!t.DOMTokenList.prototype.forEach&&(t.DOMTokenList.prototype.forEach=Array.prototype.forEach),Node.prototype.contains||(Node.prototype.contains=(...e)=>{let n=e[0];if(!(0 in e))throw new TypeError("1 argument is required");do if(this===n)return!0;while(n=n&&n.parentNode);return!1})}function ln(t){const e={},n=(o,a)=>{const i={value:o,parent:a,children:[]};return e[o.node.id]=i,i},r=[];for(const o of t){const{nextId:a,parentId:i}=o;if(a&&a in e){const s=e[a];if(s.parent){const l=s.parent.children.indexOf(s);s.parent.children.splice(l,0,n(o,s.parent))}else{const l=r.indexOf(s);r.splice(l,0,n(o,null))}continue}if(i in e){const s=e[i];s.children.push(n(o,s));continue}r.push(n(o,null))}return r}function wt(t,e){e(t.value);for(let n=t.children.length-1;n>=0;n--)wt(t.children[n],e)}function De(t,e){return Boolean(t.nodeName==="IFRAME"&&e.getMeta(t))}function Mt(t,e){return Boolean(t.nodeName==="LINK"&&t.nodeType===t.ELEMENT_NODE&&t.getAttribute&&t.getAttribute("rel")==="stylesheet"&&e.getMeta(t))}function Et(t,e){var n,r;const o=(r=(n=t.ownerDocument)==null?void 0:n.defaultView)==null?void 0:r.frameElement;if(!o||o===e)return{x:0,y:0,relativeScale:1,absoluteScale:1};const a=o.getBoundingClientRect(),i=Et(o,e),s=a.height/o.clientHeight;return{x:a.x*i.relativeScale+i.x,y:a.y*i.relativeScale+i.y,relativeScale:s,absoluteScale:i.absoluteScale*s}}function me(t){return Boolean(t?.shadowRoot)}function ke(t,e){const n=t[e[0]];return e.length===1?n:ke(n.cssRules[e[1]].cssRules,e.slice(2))}function Ct(t){const e=[...t],n=e.pop();return{positions:e,index:n}}function cn(t){const e=new Set,n=[];for(let r=t.length;r--;){const o=t[r];e.has(o.id)||(n.push(o),e.add(o.id))}return n}class Tt{constructor(){this.id=1,this.styleIDMap=new WeakMap,this.idStyleMap=new Map}getId(e){var n;return(n=this.styleIDMap.get(e))!=null?n:-1}has(e){return this.styleIDMap.has(e)}add(e,n){if(this.has(e))return this.getId(e);let r;return n===void 0?r=this.id++:r=n,this.styleIDMap.set(e,r),this.idStyleMap.set(r,e),r}getStyle(e){return this.idStyleMap.get(e)||null}reset(){this.styleIDMap=new WeakMap,this.idStyleMap=new Map,this.id=1}generateId(){return this.id++}}function It(t){var e,n;let r=null;return((n=(e=t.getRootNode)==null?void 0:e.call(t))==null?void 0:n.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&t.getRootNode().host&&(r=t.getRootNode().host),r}function un(t){let e=t,n;for(;n=It(e);)e=n;return e}function dn(t){const e=t.ownerDocument;if(!e)return!1;const n=un(t);return e.contains(n)}function Nt(t){const e=t.ownerDocument;return e?e.contains(t)||dn(t):!1}var Zr=Object.freeze({__proto__:null,on:Y,get _mirror(){return G.mirror},throttle:Ne,hookSetter:We,patch:Se,get nowTimestamp(){return Be},getWindowScroll:ft,getWindowHeight:yt,getWindowWidth:gt,closestElementOfNode:vt,isBlocked:X,isSerialized:an,isIgnored:Qe,isAncestorRemoved:St,legacy_isTouchEvent:Je,polyfill:bt,queueToResolveTrees:ln,iterateResolveTree:wt,isSerializedIframe:De,isSerializedStylesheet:Mt,getBaseDimension:Et,hasShadowRoot:me,getNestedRule:ke,getPositionsAndIndex:Ct,uniqueTextMutations:cn,StyleSheetMirror:Tt,getShadowHost:It,getRootShadowHost:un,shadowHostInDom:dn,inDom:Nt}),C=(t=>(t[t.DomContentLoaded=0]="DomContentLoaded",t[t.Load=1]="Load",t[t.FullSnapshot=2]="FullSnapshot",t[t.IncrementalSnapshot=3]="IncrementalSnapshot",t[t.Meta=4]="Meta",t[t.Custom=5]="Custom",t[t.Plugin=6]="Plugin",t))(C||{}),E=(t=>(t[t.Mutation=0]="Mutation",t[t.MouseMove=1]="MouseMove",t[t.MouseInteraction=2]="MouseInteraction",t[t.Scroll=3]="Scroll",t[t.ViewportResize=4]="ViewportResize",t[t.Input=5]="Input",t[t.TouchMove=6]="TouchMove",t[t.MediaInteraction=7]="MediaInteraction",t[t.StyleSheetRule=8]="StyleSheetRule",t[t.CanvasMutation=9]="CanvasMutation",t[t.Font=10]="Font",t[t.Log=11]="Log",t[t.Drag=12]="Drag",t[t.StyleDeclaration=13]="StyleDeclaration",t[t.Selection=14]="Selection",t[t.AdoptedStyleSheet=15]="AdoptedStyleSheet",t[t.CustomElement=16]="CustomElement",t))(E||{}),A=(t=>(t[t.MouseUp=0]="MouseUp",t[t.MouseDown=1]="MouseDown",t[t.Click=2]="Click",t[t.ContextMenu=3]="ContextMenu",t[t.DblClick=4]="DblClick",t[t.Focus=5]="Focus",t[t.Blur=6]="Blur",t[t.TouchStart=7]="TouchStart",t[t.TouchMove_Departed=8]="TouchMove_Departed",t[t.TouchEnd=9]="TouchEnd",t[t.TouchCancel=10]="TouchCancel",t))(A||{}),ce=(t=>(t[t.Mouse=0]="Mouse",t[t.Pen=1]="Pen",t[t.Touch=2]="Touch",t))(ce||{}),ue=(t=>(t[t["2D"]=0]="2D",t[t.WebGL=1]="WebGL",t[t.WebGL2=2]="WebGL2",t))(ue||{}),fe=(t=>(t[t.Play=0]="Play",t[t.Pause=1]="Pause",t[t.Seeked=2]="Seeked",t[t.VolumeChange=3]="VolumeChange",t[t.RateChange=4]="RateChange",t))(fe||{}),O=(t=>(t.Start="start",t.Pause="pause",t.Resume="resume",t.Resize="resize",t.Finish="finish",t.FullsnapshotRebuilded="fullsnapshot-rebuilded",t.LoadStylesheetStart="load-stylesheet-start",t.LoadStylesheetEnd="load-stylesheet-end",t.SkipStart="skip-start",t.SkipEnd="skip-end",t.MouseInteraction="mouse-interaction",t.EventCast="event-cast",t.CustomEvent="custom-event",t.Flush="flush",t.StateChange="state-change",t.PlayBack="play-back",t.Destroy="destroy",t))(O||{});function hn(t){return"__ln"in t}class eo{constructor(){this.length=0,this.head=null,this.tail=null}get(e){if(e>=this.length)throw new Error("Position outside of list range");let n=this.head;for(let r=0;r<e;r++)n=n?.next||null;return n}addNode(e){const n={value:e,previous:null,next:null};if(e.__ln=n,e.previousSibling&&hn(e.previousSibling)){const r=e.previousSibling.__ln.next;n.next=r,n.previous=e.previousSibling.__ln,e.previousSibling.__ln.next=n,r&&(r.previous=n)}else if(e.nextSibling&&hn(e.nextSibling)&&e.nextSibling.__ln.previous){const r=e.nextSibling.__ln.previous;n.previous=r,n.next=e.nextSibling.__ln,e.nextSibling.__ln.previous=n,r&&(r.next=n)}else this.head&&(this.head.previous=n),n.next=this.head,this.head=n;n.next===null&&(this.tail=n),this.length++}removeNode(e){const n=e.__ln;!this.head||(n.previous?(n.previous.next=n.next,n.next?n.next.previous=n.previous:this.tail=n.previous):(this.head=n.next,this.head?this.head.previous=null:this.tail=null),e.__ln&&delete e.__ln,this.length--)}}const pn=(t,e)=>`${t}@${e}`;class to{constructor(){this.frozen=!1,this.locked=!1,this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.mapRemoves=[],this.movedMap={},this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.processMutations=e=>{e.forEach(this.processMutation),this.emit()},this.emit=()=>{if(this.frozen||this.locked)return;const e=[],n=new Set,r=new eo,o=l=>{let c=l,u=$e;for(;u===$e;)c=c&&c.nextSibling,u=c&&this.mirror.getId(c);return u},a=l=>{if(!l.parentNode||!Nt(l)||l.parentNode.tagName==="TEXTAREA")return;const c=Fe(l.parentNode)?this.mirror.getId(It(l)):this.mirror.getId(l.parentNode),u=o(l);if(c===-1||u===-1)return r.addNode(l);const d=Te(l,{doc:this.doc,mirror:this.mirror,blockClass:this.blockClass,blockSelector:this.blockSelector,maskTextClass:this.maskTextClass,maskTextSelector:this.maskTextSelector,skipChild:!0,newlyAddedElement:!0,inlineStylesheet:this.inlineStylesheet,maskInputOptions:this.maskInputOptions,maskTextFn:this.maskTextFn,maskInputFn:this.maskInputFn,slimDOMOptions:this.slimDOMOptions,dataURLOptions:this.dataURLOptions,recordCanvas:this.recordCanvas,inlineImages:this.inlineImages,onSerialize:h=>{De(h,this.mirror)&&this.iframeManager.addIframe(h),Mt(h,this.mirror)&&this.stylesheetManager.trackLinkElement(h),me(l)&&this.shadowDomManager.addShadowRoot(l.shadowRoot,this.doc)},onIframeLoad:(h,m)=>{this.iframeManager.attachIframe(h,m),this.shadowDomManager.observeAttachShadow(h)},onStylesheetLoad:(h,m)=>{this.stylesheetManager.attachLinkElement(h,m)}});d&&(e.push({parentId:c,nextId:u,node:d}),n.add(d.id))};for(;this.mapRemoves.length;)this.mirror.removeNodeFromMap(this.mapRemoves.shift());for(const l of this.movedSet)mn(this.removes,l,this.mirror)&&!this.movedSet.has(l.parentNode)||a(l);for(const l of this.addedSet)!yn(this.droppedSet,l)&&!mn(this.removes,l,this.mirror)||yn(this.movedSet,l)?a(l):this.droppedSet.add(l);let i=null;for(;r.length;){let l=null;if(i){const c=this.mirror.getId(i.value.parentNode),u=o(i.value);c!==-1&&u!==-1&&(l=i)}if(!l){let c=r.tail;for(;c;){const u=c;if(c=c.previous,u){const d=this.mirror.getId(u.value.parentNode);if(o(u.value)===-1)continue;if(d!==-1){l=u;break}else{const h=u.value;if(h.parentNode&&h.parentNode.nodeType===Node.DOCUMENT_FRAGMENT_NODE){const m=h.parentNode.host;if(this.mirror.getId(m)!==-1){l=u;break}}}}}}if(!l){for(;r.head;)r.removeNode(r.head.value);break}i=l.previous,r.removeNode(l.value),a(l.value)}const s={texts:this.texts.map(l=>{const c=l.node;return c.parentNode&&c.parentNode.tagName==="TEXTAREA"&&this.genTextAreaValueMutation(c.parentNode),{id:this.mirror.getId(c),value:l.value}}).filter(l=>!n.has(l.id)).filter(l=>this.mirror.has(l.id)),attributes:this.attributes.map(l=>{const{attributes:c}=l;if(typeof c.style=="string"){const u=JSON.stringify(l.styleDiff),d=JSON.stringify(l._unchangedStyles);u.length<c.style.length&&(u+d).split("var(").length===c.style.split("var(").length&&(c.style=l.styleDiff)}return{id:this.mirror.getId(l.node),attributes:c}}).filter(l=>!n.has(l.id)).filter(l=>this.mirror.has(l.id)),removes:this.removes,adds:e};!s.texts.length&&!s.attributes.length&&!s.removes.length&&!s.adds.length||(this.texts=[],this.attributes=[],this.attributeMap=new WeakMap,this.removes=[],this.addedSet=new Set,this.movedSet=new Set,this.droppedSet=new Set,this.movedMap={},this.mutationCb(s))},this.genTextAreaValueMutation=e=>{let n=this.attributeMap.get(e);n||(n={node:e,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(n),this.attributeMap.set(e,n)),n.attributes.value=Array.from(e.childNodes,r=>r.textContent||"").join("")},this.processMutation=e=>{if(!Qe(e.target,this.mirror))switch(e.type){case"characterData":{const n=e.target.textContent;!X(e.target,this.blockClass,this.blockSelector,!1)&&n!==e.oldValue&&this.texts.push({value:Kt(e.target,this.maskTextClass,this.maskTextSelector,!0)&&n?this.maskTextFn?this.maskTextFn(n,vt(e.target)):n.replace(/[\S]/g,"*"):n,node:e.target});break}case"attributes":{const n=e.target;let r=e.attributeName,o=e.target.getAttribute(r);if(r==="value"){const i=ht(n);o=dt({element:n,maskInputOptions:this.maskInputOptions,tagName:n.tagName,type:i,value:o,maskInputFn:this.maskInputFn})}if(X(e.target,this.blockClass,this.blockSelector,!1)||o===e.oldValue)return;let a=this.attributeMap.get(e.target);if(n.tagName==="IFRAME"&&r==="src"&&!this.keepIframeSrcFn(o))if(!n.contentDocument)r="rr_src";else return;if(a||(a={node:e.target,attributes:{},styleDiff:{},_unchangedStyles:{}},this.attributes.push(a),this.attributeMap.set(e.target,a)),r==="type"&&n.tagName==="INPUT"&&(e.oldValue||"").toLowerCase()==="password"&&n.setAttribute("data-rr-is-password","true"),!Jt(n.tagName,r)&&(a.attributes[r]=Qt(this.doc,he(n.tagName),he(r),o),r==="style")){if(!this.unattachedDoc)try{this.unattachedDoc=document.implementation.createHTMLDocument()}catch{this.unattachedDoc=this.doc}const i=this.unattachedDoc.createElement("span");e.oldValue&&i.setAttribute("style",e.oldValue);for(const s of Array.from(n.style)){const l=n.style.getPropertyValue(s),c=n.style.getPropertyPriority(s);l!==i.style.getPropertyValue(s)||c!==i.style.getPropertyPriority(s)?c===""?a.styleDiff[s]=l:a.styleDiff[s]=[l,c]:a._unchangedStyles[s]=[l,c]}for(const s of Array.from(i.style))n.style.getPropertyValue(s)===""&&(a.styleDiff[s]=!1)}break}case"childList":{if(X(e.target,this.blockClass,this.blockSelector,!0))return;if(e.target.tagName==="TEXTAREA"){this.genTextAreaValueMutation(e.target);return}e.addedNodes.forEach(n=>this.genAdds(n,e.target)),e.removedNodes.forEach(n=>{const r=this.mirror.getId(n),o=Fe(e.target)?this.mirror.getId(e.target.host):this.mirror.getId(e.target);X(e.target,this.blockClass,this.blockSelector,!1)||Qe(n,this.mirror)||!an(n,this.mirror)||(this.addedSet.has(n)?(Dt(this.addedSet,n),this.droppedSet.add(n)):this.addedSet.has(e.target)&&r===-1||St(e.target,this.mirror)||(this.movedSet.has(n)&&this.movedMap[pn(r,o)]?Dt(this.movedSet,n):this.removes.push({parentId:o,id:r,isShadow:Fe(e.target)&&Pe(e.target)?!0:void 0})),this.mapRemoves.push(n))});break}}},this.genAdds=(e,n)=>{if(!this.processedNodeManager.inOtherBuffer(e,this)&&!(this.addedSet.has(e)||this.movedSet.has(e))){if(this.mirror.hasNode(e)){if(Qe(e,this.mirror))return;this.movedSet.add(e);let r=null;n&&this.mirror.hasNode(n)&&(r=this.mirror.getId(n)),r&&r!==-1&&(this.movedMap[pn(this.mirror.getId(e),r)]=!0)}else this.addedSet.add(e),this.droppedSet.delete(e);X(e,this.blockClass,this.blockSelector,!1)||(e.childNodes.forEach(r=>this.genAdds(r)),me(e)&&e.shadowRoot.childNodes.forEach(r=>{this.processedNodeManager.add(r,this),this.genAdds(r,e)}))}}}init(e){["mutationCb","blockClass","blockSelector","maskTextClass","maskTextSelector","inlineStylesheet","maskInputOptions","maskTextFn","maskInputFn","keepIframeSrcFn","recordCanvas","inlineImages","slimDOMOptions","dataURLOptions","doc","mirror","iframeManager","stylesheetManager","shadowDomManager","canvasManager","processedNodeManager"].forEach(n=>{this[n]=e[n]})}freeze(){this.frozen=!0,this.canvasManager.freeze()}unfreeze(){this.frozen=!1,this.canvasManager.unfreeze(),this.emit()}isFrozen(){return this.frozen}lock(){this.locked=!0,this.canvasManager.lock()}unlock(){this.locked=!1,this.canvasManager.unlock(),this.emit()}reset(){this.shadowDomManager.reset(),this.canvasManager.reset()}}function Dt(t,e){t.delete(e),e.childNodes.forEach(n=>Dt(t,n))}function mn(t,e,n){return t.length===0?!1:fn(t,e,n)}function fn(t,e,n){const{parentNode:r}=e;if(!r)return!1;const o=n.getId(r);return t.some(a=>a.id===o)?!0:fn(t,r,n)}function yn(t,e){return t.size===0?!1:gn(t,e)}function gn(t,e){const{parentNode:n}=e;return n?t.has(n)?!0:gn(t,n):!1}let Ve;function no(t){Ve=t}function ro(){Ve=void 0}const x=t=>Ve?(...e)=>{try{return t(...e)}catch(n){if(Ve&&Ve(n)===!0)return;throw n}}:t;var oo=Object.defineProperty,so=Object.defineProperties,io=Object.getOwnPropertyDescriptors,vn=Object.getOwnPropertySymbols,ao=Object.prototype.hasOwnProperty,lo=Object.prototype.propertyIsEnumerable,Sn=(t,e,n)=>e in t?oo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,bn=(t,e)=>{for(var n in e||(e={}))ao.call(e,n)&&Sn(t,n,e[n]);if(vn)for(var n of vn(e))lo.call(e,n)&&Sn(t,n,e[n]);return t},co=(t,e)=>so(t,io(e));const be=[];function je(t){try{if("composedPath"in t){const e=t.composedPath();if(e.length)return e[0]}else if("path"in t&&t.path.length)return t.path[0]}catch{}return t&&t.target}function wn(t,e){var n,r;const o=new to;be.push(o),o.init(t);let a=window.MutationObserver||window.__rrMutationObserver;const i=(r=(n=window?.Zone)==null?void 0:n.__symbol__)==null?void 0:r.call(n,"MutationObserver");i&&window[i]&&(a=window[i]);const s=new a(x(o.processMutations.bind(o)));return s.observe(e,{attributes:!0,attributeOldValue:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0}),s}function uo({mousemoveCb:t,sampling:e,doc:n,mirror:r}){if(e.mousemove===!1)return()=>{};const o=typeof e.mousemove=="number"?e.mousemove:50,a=typeof e.mousemoveCallback=="number"?e.mousemoveCallback:500;let i=[],s;const l=Ne(x(d=>{const h=Date.now()-s;t(i.map(m=>(m.timeOffset-=h,m)),d),i=[],s=null}),a),c=x(Ne(x(d=>{const h=je(d),{clientX:m,clientY:y}=Je(d)?d.changedTouches[0]:d;s||(s=Be()),i.push({x:m,y,id:r.getId(h),timeOffset:Be()-s}),l(typeof DragEvent<"u"&&d instanceof DragEvent?E.Drag:d instanceof MouseEvent?E.MouseMove:E.TouchMove)}),o,{trailing:!1})),u=[Y("mousemove",c,n),Y("touchmove",c,n),Y("drag",c,n)];return x(()=>{u.forEach(d=>d())})}function ho({mouseInteractionCb:t,doc:e,mirror:n,blockClass:r,blockSelector:o,sampling:a}){if(a.mouseInteraction===!1)return()=>{};const i=a.mouseInteraction===!0||a.mouseInteraction===void 0?{}:a.mouseInteraction,s=[];let l=null;const c=u=>d=>{const h=je(d);if(X(h,r,o,!0))return;let m=null,y=u;if("pointerType"in d){switch(d.pointerType){case"mouse":m=ce.Mouse;break;case"touch":m=ce.Touch;break;case"pen":m=ce.Pen;break}m===ce.Touch?A[u]===A.MouseDown?y="TouchStart":A[u]===A.MouseUp&&(y="TouchEnd"):ce.Pen}else Je(d)&&(m=ce.Touch);m!==null?(l=m,(y.startsWith("Touch")&&m===ce.Touch||y.startsWith("Mouse")&&m===ce.Mouse)&&(m=null)):A[u]===A.Click&&(m=l,l=null);const p=Je(d)?d.changedTouches[0]:d;if(!p)return;const v=n.getId(h),{clientX:f,clientY:S}=p;x(t)(bn({type:A[y],id:v,x:f,y:S},m!==null&&{pointerType:m}))};return Object.keys(A).filter(u=>Number.isNaN(Number(u))&&!u.endsWith("_Departed")&&i[u]!==!1).forEach(u=>{let d=he(u);const h=c(u);if(window.PointerEvent)switch(A[u]){case A.MouseDown:case A.MouseUp:d=d.replace("mouse","pointer");break;case A.TouchStart:case A.TouchEnd:return}s.push(Y(d,h,e))}),x(()=>{s.forEach(u=>u())})}function Mn({scrollCb:t,doc:e,mirror:n,blockClass:r,blockSelector:o,sampling:a}){const i=x(Ne(x(s=>{const l=je(s);if(!l||X(l,r,o,!0))return;const c=n.getId(l);if(l===e&&e.defaultView){const u=ft(e.defaultView);t({id:c,x:u.left,y:u.top})}else t({id:c,x:l.scrollLeft,y:l.scrollTop})}),a.scroll||100));return Y("scroll",i,e)}function po({viewportResizeCb:t},{win:e}){let n=-1,r=-1;const o=x(Ne(x(()=>{const a=yt(),i=gt();(n!==a||r!==i)&&(t({width:Number(i),height:Number(a)}),n=a,r=i)}),200));return Y("resize",o,e)}const mo=["INPUT","TEXTAREA","SELECT"],En=new WeakMap;function fo({inputCb:t,doc:e,mirror:n,blockClass:r,blockSelector:o,ignoreClass:a,ignoreSelector:i,maskInputOptions:s,maskInputFn:l,sampling:c,userTriggeredOnInput:u}){function d(f){let S=je(f);const g=f.isTrusted,w=S&&S.tagName;if(S&&w==="OPTION"&&(S=S.parentElement),!S||!w||mo.indexOf(w)<0||X(S,r,o,!0)||S.classList.contains(a)||i&&S.matches(i))return;let I=S.value,L=!1;const j=ht(S)||"";j==="radio"||j==="checkbox"?L=S.checked:(s[w.toLowerCase()]||s[j])&&(I=dt({element:S,maskInputOptions:s,tagName:w,type:j,value:I,maskInputFn:l})),h(S,u?{text:I,isChecked:L,userTriggered:g}:{text:I,isChecked:L});const z=S.name;j==="radio"&&z&&L&&e.querySelectorAll(`input[type="radio"][name="${z}"]`).forEach(Q=>{if(Q!==S){const J=Q.value;h(Q,u?{text:J,isChecked:!L,userTriggered:!1}:{text:J,isChecked:!L})}})}function h(f,S){const g=En.get(f);if(!g||g.text!==S.text||g.isChecked!==S.isChecked){En.set(f,S);const w=n.getId(f);x(t)(co(bn({},S),{id:w}))}}const m=(c.input==="last"?["change"]:["input","change"]).map(f=>Y(f,x(d),e)),y=e.defaultView;if(!y)return()=>{m.forEach(f=>f())};const p=y.Object.getOwnPropertyDescriptor(y.HTMLInputElement.prototype,"value"),v=[[y.HTMLInputElement.prototype,"value"],[y.HTMLInputElement.prototype,"checked"],[y.HTMLSelectElement.prototype,"value"],[y.HTMLTextAreaElement.prototype,"value"],[y.HTMLSelectElement.prototype,"selectedIndex"],[y.HTMLOptionElement.prototype,"selected"]];return p&&p.set&&m.push(...v.map(f=>We(f[0],f[1],{set(){x(d)({target:this,isTrusted:!1})}},!1,y))),x(()=>{m.forEach(f=>f())})}function Ke(t){const e=[];function n(r,o){if(Ze("CSSGroupingRule")&&r.parentRule instanceof CSSGroupingRule||Ze("CSSMediaRule")&&r.parentRule instanceof CSSMediaRule||Ze("CSSSupportsRule")&&r.parentRule instanceof CSSSupportsRule||Ze("CSSConditionRule")&&r.parentRule instanceof CSSConditionRule){const a=Array.from(r.parentRule.cssRules).indexOf(r);o.unshift(a)}else if(r.parentStyleSheet){const a=Array.from(r.parentStyleSheet.cssRules).indexOf(r);o.unshift(a)}return o}return n(t,e)}function ye(t,e,n){let r,o;return t?(t.ownerNode?r=e.getId(t.ownerNode):o=n.getId(t),{styleId:o,id:r}):{}}function yo({styleSheetRuleCb:t,mirror:e,stylesheetManager:n},{win:r}){if(!r.CSSStyleSheet||!r.CSSStyleSheet.prototype)return()=>{};const o=r.CSSStyleSheet.prototype.insertRule;r.CSSStyleSheet.prototype.insertRule=new Proxy(o,{apply:x((u,d,h)=>{const[m,y]=h,{id:p,styleId:v}=ye(d,e,n.styleMirror);return(p&&p!==-1||v&&v!==-1)&&t({id:p,styleId:v,adds:[{rule:m,index:y}]}),u.apply(d,h)})});const a=r.CSSStyleSheet.prototype.deleteRule;r.CSSStyleSheet.prototype.deleteRule=new Proxy(a,{apply:x((u,d,h)=>{const[m]=h,{id:y,styleId:p}=ye(d,e,n.styleMirror);return(y&&y!==-1||p&&p!==-1)&&t({id:y,styleId:p,removes:[{index:m}]}),u.apply(d,h)})});let i;r.CSSStyleSheet.prototype.replace&&(i=r.CSSStyleSheet.prototype.replace,r.CSSStyleSheet.prototype.replace=new Proxy(i,{apply:x((u,d,h)=>{const[m]=h,{id:y,styleId:p}=ye(d,e,n.styleMirror);return(y&&y!==-1||p&&p!==-1)&&t({id:y,styleId:p,replace:m}),u.apply(d,h)})}));let s;r.CSSStyleSheet.prototype.replaceSync&&(s=r.CSSStyleSheet.prototype.replaceSync,r.CSSStyleSheet.prototype.replaceSync=new Proxy(s,{apply:x((u,d,h)=>{const[m]=h,{id:y,styleId:p}=ye(d,e,n.styleMirror);return(y&&y!==-1||p&&p!==-1)&&t({id:y,styleId:p,replaceSync:m}),u.apply(d,h)})}));const l={};et("CSSGroupingRule")?l.CSSGroupingRule=r.CSSGroupingRule:(et("CSSMediaRule")&&(l.CSSMediaRule=r.CSSMediaRule),et("CSSConditionRule")&&(l.CSSConditionRule=r.CSSConditionRule),et("CSSSupportsRule")&&(l.CSSSupportsRule=r.CSSSupportsRule));const c={};return Object.entries(l).forEach(([u,d])=>{c[u]={insertRule:d.prototype.insertRule,deleteRule:d.prototype.deleteRule},d.prototype.insertRule=new Proxy(c[u].insertRule,{apply:x((h,m,y)=>{const[p,v]=y,{id:f,styleId:S}=ye(m.parentStyleSheet,e,n.styleMirror);return(f&&f!==-1||S&&S!==-1)&&t({id:f,styleId:S,adds:[{rule:p,index:[...Ke(m),v||0]}]}),h.apply(m,y)})}),d.prototype.deleteRule=new Proxy(c[u].deleteRule,{apply:x((h,m,y)=>{const[p]=y,{id:v,styleId:f}=ye(m.parentStyleSheet,e,n.styleMirror);return(v&&v!==-1||f&&f!==-1)&&t({id:v,styleId:f,removes:[{index:[...Ke(m),p]}]}),h.apply(m,y)})})}),x(()=>{r.CSSStyleSheet.prototype.insertRule=o,r.CSSStyleSheet.prototype.deleteRule=a,i&&(r.CSSStyleSheet.prototype.replace=i),s&&(r.CSSStyleSheet.prototype.replaceSync=s),Object.entries(l).forEach(([u,d])=>{d.prototype.insertRule=c[u].insertRule,d.prototype.deleteRule=c[u].deleteRule})})}function Cn({mirror:t,stylesheetManager:e},n){var r,o,a;let i=null;n.nodeName==="#document"?i=t.getId(n):i=t.getId(n.host);const s=n.nodeName==="#document"?(r=n.defaultView)==null?void 0:r.Document:(a=(o=n.ownerDocument)==null?void 0:o.defaultView)==null?void 0:a.ShadowRoot,l=s!=null&&s.prototype?Object.getOwnPropertyDescriptor(s?.prototype,"adoptedStyleSheets"):void 0;return i===null||i===-1||!s||!l?()=>{}:(Object.defineProperty(n,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get(){var c;return(c=l.get)==null?void 0:c.call(this)},set(c){var u;const d=(u=l.set)==null?void 0:u.call(this,c);if(i!==null&&i!==-1)try{e.adoptStyleSheets(c,i)}catch{}return d}}),x(()=>{Object.defineProperty(n,"adoptedStyleSheets",{configurable:l.configurable,enumerable:l.enumerable,get:l.get,set:l.set})}))}function go({styleDeclarationCb:t,mirror:e,ignoreCSSAttributes:n,stylesheetManager:r},{win:o}){const a=o.CSSStyleDeclaration.prototype.setProperty;o.CSSStyleDeclaration.prototype.setProperty=new Proxy(a,{apply:x((s,l,c)=>{var u;const[d,h,m]=c;if(n.has(d))return a.apply(l,[d,h,m]);const{id:y,styleId:p}=ye((u=l.parentRule)==null?void 0:u.parentStyleSheet,e,r.styleMirror);return(y&&y!==-1||p&&p!==-1)&&t({id:y,styleId:p,set:{property:d,value:h,priority:m},index:Ke(l.parentRule)}),s.apply(l,c)})});const i=o.CSSStyleDeclaration.prototype.removeProperty;return o.CSSStyleDeclaration.prototype.removeProperty=new Proxy(i,{apply:x((s,l,c)=>{var u;const[d]=c;if(n.has(d))return i.apply(l,[d]);const{id:h,styleId:m}=ye((u=l.parentRule)==null?void 0:u.parentStyleSheet,e,r.styleMirror);return(h&&h!==-1||m&&m!==-1)&&t({id:h,styleId:m,remove:{property:d},index:Ke(l.parentRule)}),s.apply(l,c)})}),x(()=>{o.CSSStyleDeclaration.prototype.setProperty=a,o.CSSStyleDeclaration.prototype.removeProperty=i})}function vo({mediaInteractionCb:t,blockClass:e,blockSelector:n,mirror:r,sampling:o,doc:a}){const i=x(l=>Ne(x(c=>{const u=je(c);if(!u||X(u,e,n,!0))return;const{currentTime:d,volume:h,muted:m,playbackRate:y,loop:p}=u;t({type:l,id:r.getId(u),currentTime:d,volume:h,muted:m,playbackRate:y,loop:p})}),o.media||500)),s=[Y("play",i(fe.Play),a),Y("pause",i(fe.Pause),a),Y("seeked",i(fe.Seeked),a),Y("volumechange",i(fe.VolumeChange),a),Y("ratechange",i(fe.RateChange),a)];return x(()=>{s.forEach(l=>l())})}function So({fontCb:t,doc:e}){const n=e.defaultView;if(!n)return()=>{};const r=[],o=new WeakMap,a=n.FontFace;n.FontFace=function(s,l,c){const u=new a(s,l,c);return o.set(u,{family:s,buffer:typeof l!="string",descriptors:c,fontSource:typeof l=="string"?l:JSON.stringify(Array.from(new Uint8Array(l)))}),u};const i=Se(e.fonts,"add",function(s){return function(l){return setTimeout(x(()=>{const c=o.get(l);c&&(t(c),o.delete(l))}),0),s.apply(this,[l])}});return r.push(()=>{n.FontFace=a}),r.push(i),x(()=>{r.forEach(s=>s())})}function bo(t){const{doc:e,mirror:n,blockClass:r,blockSelector:o,selectionCb:a}=t;let i=!0;const s=x(()=>{const l=e.getSelection();if(!l||i&&l?.isCollapsed)return;i=l.isCollapsed||!1;const c=[],u=l.rangeCount||0;for(let d=0;d<u;d++){const h=l.getRangeAt(d),{startContainer:m,startOffset:y,endContainer:p,endOffset:v}=h;X(m,r,o,!0)||X(p,r,o,!0)||c.push({start:n.getId(m),startOffset:y,end:n.getId(p),endOffset:v})}a({ranges:c})});return s(),Y("selectionchange",s)}function wo({doc:t,customElementCb:e}){const n=t.defaultView;return!n||!n.customElements?()=>{}:Se(n.customElements,"define",function(r){return function(o,a,i){try{e({define:{name:o}})}catch{console.warn(`Custom element callback failed for ${o}`)}return r.apply(this,[o,a,i])}})}function Mo(t,e){const{mutationCb:n,mousemoveCb:r,mouseInteractionCb:o,scrollCb:a,viewportResizeCb:i,inputCb:s,mediaInteractionCb:l,styleSheetRuleCb:c,styleDeclarationCb:u,canvasMutationCb:d,fontCb:h,selectionCb:m,customElementCb:y}=t;t.mutationCb=(...p)=>{e.mutation&&e.mutation(...p),n(...p)},t.mousemoveCb=(...p)=>{e.mousemove&&e.mousemove(...p),r(...p)},t.mouseInteractionCb=(...p)=>{e.mouseInteraction&&e.mouseInteraction(...p),o(...p)},t.scrollCb=(...p)=>{e.scroll&&e.scroll(...p),a(...p)},t.viewportResizeCb=(...p)=>{e.viewportResize&&e.viewportResize(...p),i(...p)},t.inputCb=(...p)=>{e.input&&e.input(...p),s(...p)},t.mediaInteractionCb=(...p)=>{e.mediaInteaction&&e.mediaInteaction(...p),l(...p)},t.styleSheetRuleCb=(...p)=>{e.styleSheetRule&&e.styleSheetRule(...p),c(...p)},t.styleDeclarationCb=(...p)=>{e.styleDeclaration&&e.styleDeclaration(...p),u(...p)},t.canvasMutationCb=(...p)=>{e.canvasMutation&&e.canvasMutation(...p),d(...p)},t.fontCb=(...p)=>{e.font&&e.font(...p),h(...p)},t.selectionCb=(...p)=>{e.selection&&e.selection(...p),m(...p)},t.customElementCb=(...p)=>{e.customElement&&e.customElement(...p),y(...p)}}function Eo(t,e={}){const n=t.doc.defaultView;if(!n)return()=>{};Mo(t,e);let r;t.recordDOM&&(r=wn(t,t.doc));const o=uo(t),a=ho(t),i=Mn(t),s=po(t,{win:n}),l=fo(t),c=vo(t);let u=()=>{},d=()=>{},h=()=>{},m=()=>{};t.recordDOM&&(u=yo(t,{win:n}),d=Cn(t,t.doc),h=go(t,{win:n}),t.collectFonts&&(m=So(t)));const y=bo(t),p=wo(t),v=[];for(const f of t.plugins)v.push(f.observer(f.callback,n,f.options));return x(()=>{be.forEach(f=>f.reset()),r?.disconnect(),o(),a(),i(),s(),l(),c(),u(),d(),h(),m(),y(),p(),v.forEach(f=>f())})}function Ze(t){return typeof window[t]<"u"}function et(t){return Boolean(typeof window[t]<"u"&&window[t].prototype&&"insertRule"in window[t].prototype&&"deleteRule"in window[t].prototype)}class Tn{constructor(e){this.generateIdFn=e,this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap}getId(e,n,r,o){const a=r||this.getIdToRemoteIdMap(e),i=o||this.getRemoteIdToIdMap(e);let s=a.get(n);return s||(s=this.generateIdFn(),a.set(n,s),i.set(s,n)),s}getIds(e,n){const r=this.getIdToRemoteIdMap(e),o=this.getRemoteIdToIdMap(e);return n.map(a=>this.getId(e,a,r,o))}getRemoteId(e,n,r){const o=r||this.getRemoteIdToIdMap(e);return typeof n!="number"?n:o.get(n)||-1}getRemoteIds(e,n){const r=this.getRemoteIdToIdMap(e);return n.map(o=>this.getRemoteId(e,o,r))}reset(e){if(!e){this.iframeIdToRemoteIdMap=new WeakMap,this.iframeRemoteIdToIdMap=new WeakMap;return}this.iframeIdToRemoteIdMap.delete(e),this.iframeRemoteIdToIdMap.delete(e)}getIdToRemoteIdMap(e){let n=this.iframeIdToRemoteIdMap.get(e);return n||(n=new Map,this.iframeIdToRemoteIdMap.set(e,n)),n}getRemoteIdToIdMap(e){let n=this.iframeRemoteIdToIdMap.get(e);return n||(n=new Map,this.iframeRemoteIdToIdMap.set(e,n)),n}}class Co{constructor(e){this.iframes=new WeakMap,this.crossOriginIframeMap=new WeakMap,this.crossOriginIframeMirror=new Tn(Xt),this.crossOriginIframeRootIdMap=new WeakMap,this.mutationCb=e.mutationCb,this.wrappedEmit=e.wrappedEmit,this.stylesheetManager=e.stylesheetManager,this.recordCrossOriginIframes=e.recordCrossOriginIframes,this.crossOriginIframeStyleMirror=new Tn(this.stylesheetManager.styleMirror.generateId.bind(this.stylesheetManager.styleMirror)),this.mirror=e.mirror,this.recordCrossOriginIframes&&window.addEventListener("message",this.handleMessage.bind(this))}addIframe(e){this.iframes.set(e,!0),e.contentWindow&&this.crossOriginIframeMap.set(e.contentWindow,e)}addLoadListener(e){this.loadListener=e}attachIframe(e,n){var r;this.mutationCb({adds:[{parentId:this.mirror.getId(e),nextId:null,node:n}],removes:[],texts:[],attributes:[],isAttachIframe:!0}),(r=this.loadListener)==null||r.call(this,e),e.contentDocument&&e.contentDocument.adoptedStyleSheets&&e.contentDocument.adoptedStyleSheets.length>0&&this.stylesheetManager.adoptStyleSheets(e.contentDocument.adoptedStyleSheets,this.mirror.getId(e.contentDocument))}handleMessage(e){const n=e;if(n.data.type!=="rrweb"||n.origin!==n.data.origin||!e.source)return;const r=this.crossOriginIframeMap.get(e.source);if(!r)return;const o=this.transformCrossOriginEvent(r,n.data.event);o&&this.wrappedEmit(o,n.data.isCheckout)}transformCrossOriginEvent(e,n){var r;switch(n.type){case C.FullSnapshot:{this.crossOriginIframeMirror.reset(e),this.crossOriginIframeStyleMirror.reset(e),this.replaceIdOnNode(n.data.node,e);const o=n.data.node.id;return this.crossOriginIframeRootIdMap.set(e,o),this.patchRootIdOnNode(n.data.node,o),{timestamp:n.timestamp,type:C.IncrementalSnapshot,data:{source:E.Mutation,adds:[{parentId:this.mirror.getId(e),nextId:null,node:n.data.node}],removes:[],texts:[],attributes:[],isAttachIframe:!0}}}case C.Meta:case C.Load:case C.DomContentLoaded:return!1;case C.Plugin:return n;case C.Custom:return this.replaceIds(n.data.payload,e,["id","parentId","previousId","nextId"]),n;case C.IncrementalSnapshot:switch(n.data.source){case E.Mutation:return n.data.adds.forEach(o=>{this.replaceIds(o,e,["parentId","nextId","previousId"]),this.replaceIdOnNode(o.node,e);const a=this.crossOriginIframeRootIdMap.get(e);a&&this.patchRootIdOnNode(o.node,a)}),n.data.removes.forEach(o=>{this.replaceIds(o,e,["parentId","id"])}),n.data.attributes.forEach(o=>{this.replaceIds(o,e,["id"])}),n.data.texts.forEach(o=>{this.replaceIds(o,e,["id"])}),n;case E.Drag:case E.TouchMove:case E.MouseMove:return n.data.positions.forEach(o=>{this.replaceIds(o,e,["id"])}),n;case E.ViewportResize:return!1;case E.MediaInteraction:case E.MouseInteraction:case E.Scroll:case E.CanvasMutation:case E.Input:return this.replaceIds(n.data,e,["id"]),n;case E.StyleSheetRule:case E.StyleDeclaration:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleId"]),n;case E.Font:return n;case E.Selection:return n.data.ranges.forEach(o=>{this.replaceIds(o,e,["start","end"])}),n;case E.AdoptedStyleSheet:return this.replaceIds(n.data,e,["id"]),this.replaceStyleIds(n.data,e,["styleIds"]),(r=n.data.styles)==null||r.forEach(o=>{this.replaceStyleIds(o,e,["styleId"])}),n}}return!1}replace(e,n,r,o){for(const a of o)!Array.isArray(n[a])&&typeof n[a]!="number"||(Array.isArray(n[a])?n[a]=e.getIds(r,n[a]):n[a]=e.getId(r,n[a]));return n}replaceIds(e,n,r){return this.replace(this.crossOriginIframeMirror,e,n,r)}replaceStyleIds(e,n,r){return this.replace(this.crossOriginIframeStyleMirror,e,n,r)}replaceIdOnNode(e,n){this.replaceIds(e,n,["id","rootId"]),"childNodes"in e&&e.childNodes.forEach(r=>{this.replaceIdOnNode(r,n)})}patchRootIdOnNode(e,n){e.type!==T.Document&&!e.rootId&&(e.rootId=n),"childNodes"in e&&e.childNodes.forEach(r=>{this.patchRootIdOnNode(r,n)})}}var To=Object.defineProperty,Io=Object.defineProperties,No=Object.getOwnPropertyDescriptors,In=Object.getOwnPropertySymbols,Do=Object.prototype.hasOwnProperty,ko=Object.prototype.propertyIsEnumerable,Nn=(t,e,n)=>e in t?To(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,Dn=(t,e)=>{for(var n in e||(e={}))Do.call(e,n)&&Nn(t,n,e[n]);if(In)for(var n of In(e))ko.call(e,n)&&Nn(t,n,e[n]);return t},kn=(t,e)=>Io(t,No(e));class Ro{constructor(e){this.shadowDoms=new WeakSet,this.restoreHandlers=[],this.mutationCb=e.mutationCb,this.scrollCb=e.scrollCb,this.bypassOptions=e.bypassOptions,this.mirror=e.mirror,this.init()}init(){this.reset(),this.patchAttachShadow(Element,document)}addShadowRoot(e,n){if(!Pe(e)||this.shadowDoms.has(e))return;this.shadowDoms.add(e);const r=wn(kn(Dn({},this.bypassOptions),{doc:n,mutationCb:this.mutationCb,mirror:this.mirror,shadowDomManager:this}),e);this.restoreHandlers.push(()=>r.disconnect()),this.restoreHandlers.push(Mn(kn(Dn({},this.bypassOptions),{scrollCb:this.scrollCb,doc:e,mirror:this.mirror}))),setTimeout(()=>{e.adoptedStyleSheets&&e.adoptedStyleSheets.length>0&&this.bypassOptions.stylesheetManager.adoptStyleSheets(e.adoptedStyleSheets,this.mirror.getId(e.host)),this.restoreHandlers.push(Cn({mirror:this.mirror,stylesheetManager:this.bypassOptions.stylesheetManager},e))},0)}observeAttachShadow(e){!e.contentWindow||!e.contentDocument||this.patchAttachShadow(e.contentWindow.Element,e.contentDocument)}patchAttachShadow(e,n){const r=this;this.restoreHandlers.push(Se(e.prototype,"attachShadow",function(o){return function(a){const i=o.call(this,a);return this.shadowRoot&&Nt(this)&&r.addShadowRoot(this.shadowRoot,n),i}}))}reset(){this.restoreHandlers.forEach(e=>{try{e()}catch{}}),this.restoreHandlers=[],this.shadowDoms=new WeakSet}}for(var Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ze=typeof Uint8Array>"u"?[]:new Uint8Array(256),tt=0;tt<Re.length;tt++)ze[Re.charCodeAt(tt)]=tt;var Oo=function(t){var e=new Uint8Array(t),n,r=e.length,o="";for(n=0;n<r;n+=3)o+=Re[e[n]>>2],o+=Re[(e[n]&3)<<4|e[n+1]>>4],o+=Re[(e[n+1]&15)<<2|e[n+2]>>6],o+=Re[e[n+2]&63];return r%3===2?o=o.substring(0,o.length-1)+"=":r%3===1&&(o=o.substring(0,o.length-2)+"=="),o},xo=function(t){var e=t.length*.75,n=t.length,r,o=0,a,i,s,l;t[t.length-1]==="="&&(e--,t[t.length-2]==="="&&e--);var c=new ArrayBuffer(e),u=new Uint8Array(c);for(r=0;r<n;r+=4)a=ze[t.charCodeAt(r)],i=ze[t.charCodeAt(r+1)],s=ze[t.charCodeAt(r+2)],l=ze[t.charCodeAt(r+3)],u[o++]=a<<2|i>>4,u[o++]=(i&15)<<4|s>>2,u[o++]=(s&3)<<6|l&63;return c};const Rn=new Map;function Ao(t,e){let n=Rn.get(t);return n||(n=new Map,Rn.set(t,n)),n.has(e)||n.set(e,[]),n.get(e)}const On=(t,e,n)=>{if(!t||!(An(t,e)||typeof t=="object"))return;const r=t.constructor.name,o=Ao(n,r);let a=o.indexOf(t);return a===-1&&(a=o.length,o.push(t)),a};function nt(t,e,n){if(t instanceof Array)return t.map(r=>nt(r,e,n));if(t===null)return t;if(t instanceof Float32Array||t instanceof Float64Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Uint8Array||t instanceof Uint16Array||t instanceof Int16Array||t instanceof Int8Array||t instanceof Uint8ClampedArray)return{rr_type:t.constructor.name,args:[Object.values(t)]};if(t instanceof ArrayBuffer){const r=t.constructor.name,o=Oo(t);return{rr_type:r,base64:o}}else{if(t instanceof DataView)return{rr_type:t.constructor.name,args:[nt(t.buffer,e,n),t.byteOffset,t.byteLength]};if(t instanceof HTMLImageElement){const r=t.constructor.name,{src:o}=t;return{rr_type:r,src:o}}else if(t instanceof HTMLCanvasElement){const r="HTMLImageElement",o=t.toDataURL();return{rr_type:r,src:o}}else{if(t instanceof ImageData)return{rr_type:t.constructor.name,args:[nt(t.data,e,n),t.width,t.height]};if(An(t,e)||typeof t=="object"){const r=t.constructor.name,o=On(t,e,n);return{rr_type:r,index:o}}}}return t}const xn=(t,e,n)=>t.map(r=>nt(r,e,n)),An=(t,e)=>{const n=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject","WebGLVertexArrayObjectOES"].filter(r=>typeof e[r]=="function");return Boolean(n.find(r=>t instanceof e[r]))};function Lo(t,e,n,r){const o=[],a=Object.getOwnPropertyNames(e.CanvasRenderingContext2D.prototype);for(const i of a)try{if(typeof e.CanvasRenderingContext2D.prototype[i]!="function")continue;const s=Se(e.CanvasRenderingContext2D.prototype,i,function(l){return function(...c){return X(this.canvas,n,r,!0)||setTimeout(()=>{const u=xn(c,e,this);t(this.canvas,{type:ue["2D"],property:i,args:u})},0),l.apply(this,c)}});o.push(s)}catch{const l=We(e.CanvasRenderingContext2D.prototype,i,{set(c){t(this.canvas,{type:ue["2D"],property:i,args:[c],setter:!0})}});o.push(l)}return()=>{o.forEach(i=>i())}}function _o(t){return t==="experimental-webgl"?"webgl":t}function Ln(t,e,n,r){const o=[];try{const a=Se(t.HTMLCanvasElement.prototype,"getContext",function(i){return function(s,...l){if(!X(this,e,n,!0)){const c=_o(s);if("__context"in this||(this.__context=c),r&&["webgl","webgl2"].includes(c))if(l[0]&&typeof l[0]=="object"){const u=l[0];u.preserveDrawingBuffer||(u.preserveDrawingBuffer=!0)}else l.splice(0,1,{preserveDrawingBuffer:!0})}return i.apply(this,[s,...l])}});o.push(a)}catch{console.error("failed to patch HTMLCanvasElement.prototype.getContext")}return()=>{o.forEach(a=>a())}}function _n(t,e,n,r,o,a,i){const s=[],l=Object.getOwnPropertyNames(t);for(const c of l)if(!["isContextLost","canvas","drawingBufferWidth","drawingBufferHeight"].includes(c))try{if(typeof t[c]!="function")continue;const u=Se(t,c,function(d){return function(...h){const m=d.apply(this,h);if(On(m,i,this),"tagName"in this.canvas&&!X(this.canvas,r,o,!0)){const y=xn(h,i,this),p={type:e,property:c,args:y};n(this.canvas,p)}return m}});s.push(u)}catch{const d=We(t,c,{set(h){n(this.canvas,{type:e,property:c,args:[h],setter:!0})}});s.push(d)}return s}function Fo(t,e,n,r,o){const a=[];return a.push(..._n(e.WebGLRenderingContext.prototype,ue.WebGL,t,n,r,o,e)),typeof e.WebGL2RenderingContext<"u"&&a.push(..._n(e.WebGL2RenderingContext.prototype,ue.WebGL2,t,n,r,o,e)),()=>{a.forEach(i=>i())}}function Po(t,e){var n=e===void 0?null:e,r=t.toString(),o=r.split(`
`);o.pop(),o.shift();for(var a=o[0].search(/\S/),i=/(['"])__worker_loader_strict__(['"])/g,s=0,l=o.length;s<l;++s)o[s]=o[s].substring(a).replace(i,"$1use strict$2")+`
`;return n&&o.push("//# sourceMappingURL="+n+`
`),o}function $o(t,e){var n=Po(t,e),r=new Blob(n,{type:"application/javascript"});return URL.createObjectURL(r)}function Uo(t,e){var n;return function(o){return n=n||$o(t,e),new Worker(n,o)}}var Wo=Uo(function(){(function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=typeof Uint8Array>"u"?[]:new Uint8Array(256),n=0;n<t.length;n++)e[t.charCodeAt(n)]=n;var r=function(l){var c=new Uint8Array(l),u,d=c.length,h="";for(u=0;u<d;u+=3)h+=t[c[u]>>2],h+=t[(c[u]&3)<<4|c[u+1]>>4],h+=t[(c[u+1]&15)<<2|c[u+2]>>6],h+=t[c[u+2]&63];return d%3===2?h=h.substring(0,h.length-1)+"=":d%3===1&&(h=h.substring(0,h.length-2)+"=="),h};const o=new Map,a=new Map;async function i(l,c,u){const d=`${l}-${c}`;if("OffscreenCanvas"in globalThis){if(a.has(d))return a.get(d);const h=new OffscreenCanvas(l,c);h.getContext("2d");const m=await(await h.convertToBlob(u)).arrayBuffer(),y=r(m);return a.set(d,y),y}else return""}const s=self;s.onmessage=async function(l){if("OffscreenCanvas"in globalThis){const{id:c,bitmap:u,width:d,height:h,dataURLOptions:m}=l.data,y=i(d,h,m),p=new OffscreenCanvas(d,h);p.getContext("2d").drawImage(u,0,0),u.close();const v=await p.convertToBlob(m),f=v.type,S=await v.arrayBuffer(),g=r(S);if(!o.has(c)&&await y===g)return o.set(c,g),s.postMessage({id:c});if(o.get(c)===g)return s.postMessage({id:c});s.postMessage({id:c,type:f,base64:g,width:d,height:h}),o.set(c,g)}else return s.postMessage({id:l.data.id})}})()},null),Fn=Object.getOwnPropertySymbols,Bo=Object.prototype.hasOwnProperty,Vo=Object.prototype.propertyIsEnumerable,jo=(t,e)=>{var n={};for(var r in t)Bo.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&Fn)for(var r of Fn(t))e.indexOf(r)<0&&Vo.call(t,r)&&(n[r]=t[r]);return n},zo=(t,e,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(t,e)).next())});class Ho{constructor(e){this.pendingCanvasMutations=new Map,this.rafStamps={latestId:0,invokeId:null},this.frozen=!1,this.locked=!1,this.processMutation=(l,c)=>{(this.rafStamps.invokeId&&this.rafStamps.latestId!==this.rafStamps.invokeId||!this.rafStamps.invokeId)&&(this.rafStamps.invokeId=this.rafStamps.latestId),this.pendingCanvasMutations.has(l)||this.pendingCanvasMutations.set(l,[]),this.pendingCanvasMutations.get(l).push(c)};const{sampling:n="all",win:r,blockClass:o,blockSelector:a,recordCanvas:i,dataURLOptions:s}=e;this.mutationCb=e.mutationCb,this.mirror=e.mirror,i&&n==="all"&&this.initCanvasMutationObserver(r,o,a),i&&typeof n=="number"&&this.initCanvasFPSObserver(n,r,o,a,{dataURLOptions:s})}reset(){this.pendingCanvasMutations.clear(),this.resetObservers&&this.resetObservers()}freeze(){this.frozen=!0}unfreeze(){this.frozen=!1}lock(){this.locked=!0}unlock(){this.locked=!1}initCanvasFPSObserver(e,n,r,o,a){const i=Ln(n,r,o,!0),s=new Map,l=new Wo;l.onmessage=y=>{const{id:p}=y.data;if(s.set(p,!1),!("base64"in y.data))return;const{base64:v,type:f,width:S,height:g}=y.data;this.mutationCb({id:p,type:ue["2D"],commands:[{property:"clearRect",args:[0,0,S,g]},{property:"drawImage",args:[{rr_type:"ImageBitmap",args:[{rr_type:"Blob",data:[{rr_type:"ArrayBuffer",base64:v}],type:f}]},0,0]}]})};const c=1e3/e;let u=0,d;const h=()=>{const y=[];return n.document.querySelectorAll("canvas").forEach(p=>{X(p,r,o,!0)||y.push(p)}),y},m=y=>{if(u&&y-u<c){d=requestAnimationFrame(m);return}u=y,h().forEach(p=>zo(this,null,function*(){var v;const f=this.mirror.getId(p);if(s.get(f)||p.width===0||p.height===0)return;if(s.set(f,!0),["webgl","webgl2"].includes(p.__context)){const g=p.getContext(p.__context);((v=g?.getContextAttributes())==null?void 0:v.preserveDrawingBuffer)===!1&&g.clear(g.COLOR_BUFFER_BIT)}const S=yield createImageBitmap(p);l.postMessage({id:f,bitmap:S,width:p.width,height:p.height,dataURLOptions:a.dataURLOptions},[S])})),d=requestAnimationFrame(m)};d=requestAnimationFrame(m),this.resetObservers=()=>{i(),cancelAnimationFrame(d)}}initCanvasMutationObserver(e,n,r){this.startRAFTimestamping(),this.startPendingCanvasMutationFlusher();const o=Ln(e,n,r,!1),a=Lo(this.processMutation.bind(this),e,n,r),i=Fo(this.processMutation.bind(this),e,n,r,this.mirror);this.resetObservers=()=>{o(),a(),i()}}startPendingCanvasMutationFlusher(){requestAnimationFrame(()=>this.flushPendingCanvasMutations())}startRAFTimestamping(){const e=n=>{this.rafStamps.latestId=n,requestAnimationFrame(e)};requestAnimationFrame(e)}flushPendingCanvasMutations(){this.pendingCanvasMutations.forEach((e,n)=>{const r=this.mirror.getId(n);this.flushPendingCanvasMutationFor(n,r)}),requestAnimationFrame(()=>this.flushPendingCanvasMutations())}flushPendingCanvasMutationFor(e,n){if(this.frozen||this.locked)return;const r=this.pendingCanvasMutations.get(e);if(!r||n===-1)return;const o=r.map(i=>jo(i,["type"])),{type:a}=r[0];this.mutationCb({id:n,type:a,commands:o}),this.pendingCanvasMutations.delete(e)}}class Go{constructor(e){this.trackedLinkElements=new WeakSet,this.styleMirror=new Tt,this.mutationCb=e.mutationCb,this.adoptedStyleSheetCb=e.adoptedStyleSheetCb}attachLinkElement(e,n){"_cssText"in n.attributes&&this.mutationCb({adds:[],removes:[],texts:[],attributes:[{id:n.id,attributes:n.attributes}]}),this.trackLinkElement(e)}trackLinkElement(e){this.trackedLinkElements.has(e)||(this.trackedLinkElements.add(e),this.trackStylesheetInLinkElement(e))}adoptStyleSheets(e,n){if(e.length===0)return;const r={id:n,styleIds:[]},o=[];for(const a of e){let i;this.styleMirror.has(a)?i=this.styleMirror.getId(a):(i=this.styleMirror.add(a),o.push({styleId:i,rules:Array.from(a.rules||CSSRule,(s,l)=>({rule:zt(s),index:l}))})),r.styleIds.push(i)}o.length>0&&(r.styles=o),this.adoptedStyleSheetCb(r)}reset(){this.styleMirror.reset(),this.trackedLinkElements=new WeakSet}trackStylesheetInLinkElement(e){}}class Yo{constructor(){this.nodeMap=new WeakMap,this.loop=!0,this.periodicallyClear()}periodicallyClear(){requestAnimationFrame(()=>{this.clear(),this.loop&&this.periodicallyClear()})}inOtherBuffer(e,n){const r=this.nodeMap.get(e);return r&&Array.from(r).some(o=>o!==n)}add(e,n){this.nodeMap.set(e,(this.nodeMap.get(e)||new Set).add(n))}clear(){this.nodeMap=new WeakMap}destroy(){this.loop=!1}}var Xo=Object.defineProperty,qo=Object.defineProperties,Qo=Object.getOwnPropertyDescriptors,Pn=Object.getOwnPropertySymbols,Jo=Object.prototype.hasOwnProperty,Ko=Object.prototype.propertyIsEnumerable,$n=(t,e,n)=>e in t?Xo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,ee=(t,e)=>{for(var n in e||(e={}))Jo.call(e,n)&&$n(t,n,e[n]);if(Pn)for(var n of Pn(e))Ko.call(e,n)&&$n(t,n,e[n]);return t},Zo=(t,e)=>qo(t,Qo(e));function V(t){return Zo(ee({},t),{timestamp:Be()})}let U,rt,kt,ot=!1;const ie=Ht();function we(t={}){const{emit:e,checkoutEveryNms:n,checkoutEveryNth:r,blockClass:o="rr-block",blockSelector:a=null,ignoreClass:i="rr-ignore",ignoreSelector:s=null,maskTextClass:l="rr-mask",maskTextSelector:c=null,inlineStylesheet:u=!0,maskAllInputs:d,maskInputOptions:h,slimDOMOptions:m,maskInputFn:y,maskTextFn:p,hooks:v,packFn:f,sampling:S={},dataURLOptions:g={},mousemoveWait:w,recordDOM:I=!0,recordCanvas:L=!1,recordCrossOriginIframes:j=!1,recordAfter:z=t.recordAfter==="DOMContentLoaded"?t.recordAfter:"load",userTriggeredOnInput:Q=!1,collectFonts:J=!1,inlineImages:re=!1,plugins:R,keepIframeSrcFn:oe=()=>!1,ignoreCSSAttributes:H=new Set([]),errorHandler:se}=t;no(se);const K=j?window.parent===window:!0;let F=!1;if(!K)try{window.parent.document&&(F=!1)}catch{F=!0}if(K&&!e)throw new Error("emit function is required");w!==void 0&&S.mousemove===void 0&&(S.mousemove=w),ie.reset();const de=d===!0?{color:!0,date:!0,"datetime-local":!0,email:!0,month:!0,number:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0,textarea:!0,select:!0,password:!0}:h!==void 0?h:{password:!0},ve=m===!0||m==="all"?{script:!0,comment:!0,headFavicon:!0,headWhitespace:!0,headMetaSocial:!0,headMetaRobots:!0,headMetaHttpEquiv:!0,headMetaVerification:!0,headMetaAuthorship:m==="all",headMetaDescKeywords:m==="all"}:m||{};bt();let M,b=0;const N=D=>{for(const ae of R||[])ae.eventProcessor&&(D=ae.eventProcessor(D));return f&&!F&&(D=f(D)),D};U=(D,ae)=>{var B;if(((B=be[0])==null?void 0:B.isFrozen())&&D.type!==C.FullSnapshot&&!(D.type===C.IncrementalSnapshot&&D.data.source===E.Mutation)&&be.forEach(Z=>Z.unfreeze()),K)e?.(N(D),ae);else if(F){const Z={type:"rrweb",event:N(D),origin:window.location.origin,isCheckout:ae};window.parent.postMessage(Z,"*")}if(D.type===C.FullSnapshot)M=D,b=0;else if(D.type===C.IncrementalSnapshot){if(D.data.source===E.Mutation&&D.data.isAttachIframe)return;b++;const Z=r&&b>=r,_e=n&&D.timestamp-M.timestamp>n;(Z||_e)&&rt(!0)}};const P=D=>{U(V({type:C.IncrementalSnapshot,data:ee({source:E.Mutation},D)}))},q=D=>U(V({type:C.IncrementalSnapshot,data:ee({source:E.Scroll},D)})),te=D=>U(V({type:C.IncrementalSnapshot,data:ee({source:E.CanvasMutation},D)})),ri=D=>U(V({type:C.IncrementalSnapshot,data:ee({source:E.AdoptedStyleSheet},D)})),Me=new Go({mutationCb:P,adoptedStyleSheetCb:ri}),Ee=new Co({mirror:ie,mutationCb:P,stylesheetManager:Me,recordCrossOriginIframes:j,wrappedEmit:U});for(const D of R||[])D.getMirror&&D.getMirror({nodeMirror:ie,crossOriginIframeMirror:Ee.crossOriginIframeMirror,crossOriginIframeStyleMirror:Ee.crossOriginIframeStyleMirror});const Bt=new Yo;kt=new Ho({recordCanvas:L,mutationCb:te,win:window,blockClass:o,blockSelector:a,mirror:ie,sampling:S.canvas,dataURLOptions:g});const ct=new Ro({mutationCb:P,scrollCb:q,bypassOptions:{blockClass:o,blockSelector:a,maskTextClass:l,maskTextSelector:c,inlineStylesheet:u,maskInputOptions:de,dataURLOptions:g,maskTextFn:p,maskInputFn:y,recordCanvas:L,inlineImages:re,sampling:S,slimDOMOptions:ve,iframeManager:Ee,stylesheetManager:Me,canvasManager:kt,keepIframeSrcFn:oe,processedNodeManager:Bt},mirror:ie});rt=(D=!1)=>{if(!I)return;U(V({type:C.Meta,data:{href:window.location.href,width:gt(),height:yt()}}),D),Me.reset(),ct.init(),be.forEach(B=>B.lock());const ae=zr(document,{mirror:ie,blockClass:o,blockSelector:a,maskTextClass:l,maskTextSelector:c,inlineStylesheet:u,maskAllInputs:de,maskTextFn:p,slimDOM:ve,dataURLOptions:g,recordCanvas:L,inlineImages:re,onSerialize:B=>{De(B,ie)&&Ee.addIframe(B),Mt(B,ie)&&Me.trackLinkElement(B),me(B)&&ct.addShadowRoot(B.shadowRoot,document)},onIframeLoad:(B,Z)=>{Ee.attachIframe(B,Z),ct.observeAttachShadow(B)},onStylesheetLoad:(B,Z)=>{Me.attachLinkElement(B,Z)},keepIframeSrcFn:oe});if(!ae)return console.warn("Failed to snapshot the document");U(V({type:C.FullSnapshot,data:{node:ae,initialOffset:ft(window)}}),D),be.forEach(B=>B.unlock()),document.adoptedStyleSheets&&document.adoptedStyleSheets.length>0&&Me.adoptStyleSheets(document.adoptedStyleSheets,ie.getId(document))};try{const D=[],ae=Z=>{var _e;return x(Eo)({mutationCb:P,mousemoveCb:($,Vt)=>U(V({type:C.IncrementalSnapshot,data:{source:Vt,positions:$}})),mouseInteractionCb:$=>U(V({type:C.IncrementalSnapshot,data:ee({source:E.MouseInteraction},$)})),scrollCb:q,viewportResizeCb:$=>U(V({type:C.IncrementalSnapshot,data:ee({source:E.ViewportResize},$)})),inputCb:$=>U(V({type:C.IncrementalSnapshot,data:ee({source:E.Input},$)})),mediaInteractionCb:$=>U(V({type:C.IncrementalSnapshot,data:ee({source:E.MediaInteraction},$)})),styleSheetRuleCb:$=>U(V({type:C.IncrementalSnapshot,data:ee({source:E.StyleSheetRule},$)})),styleDeclarationCb:$=>U(V({type:C.IncrementalSnapshot,data:ee({source:E.StyleDeclaration},$)})),canvasMutationCb:te,fontCb:$=>U(V({type:C.IncrementalSnapshot,data:ee({source:E.Font},$)})),selectionCb:$=>{U(V({type:C.IncrementalSnapshot,data:ee({source:E.Selection},$)}))},customElementCb:$=>{U(V({type:C.IncrementalSnapshot,data:ee({source:E.CustomElement},$)}))},blockClass:o,ignoreClass:i,ignoreSelector:s,maskTextClass:l,maskTextSelector:c,maskInputOptions:de,inlineStylesheet:u,sampling:S,recordDOM:I,recordCanvas:L,inlineImages:re,userTriggeredOnInput:Q,collectFonts:J,doc:Z,maskInputFn:y,maskTextFn:p,keepIframeSrcFn:oe,blockSelector:a,slimDOMOptions:ve,dataURLOptions:g,mirror:ie,iframeManager:Ee,stylesheetManager:Me,shadowDomManager:ct,processedNodeManager:Bt,canvasManager:kt,ignoreCSSAttributes:H,plugins:((_e=R?.filter($=>$.observer))==null?void 0:_e.map($=>({observer:$.observer,options:$.options,callback:Vt=>U(V({type:C.Plugin,data:{plugin:$.name,payload:Vt}}))})))||[]},v)};Ee.addLoadListener(Z=>{try{D.push(ae(Z.contentDocument))}catch(_e){console.warn(_e)}});const B=()=>{rt(),D.push(ae(document)),ot=!0};return document.readyState==="interactive"||document.readyState==="complete"?B():(D.push(Y("DOMContentLoaded",()=>{U(V({type:C.DomContentLoaded,data:{}})),z==="DOMContentLoaded"&&B()})),D.push(Y("load",()=>{U(V({type:C.Load,data:{}})),z==="load"&&B()},window))),()=>{D.forEach(Z=>Z()),Bt.destroy(),ot=!1,ro()}}catch(D){console.warn(D)}}we.addCustomEvent=(t,e)=>{if(!ot)throw new Error("please add custom event after start recording");U(V({type:C.Custom,data:{tag:t,payload:e}}))},we.freezePage=()=>{be.forEach(t=>t.freeze())},we.takeFullSnapshot=t=>{if(!ot)throw new Error("please take full snapshot after start recording");rt(t)},we.mirror=ie;var k;(function(t){t[t.Document=0]="Document",t[t.DocumentType=1]="DocumentType",t[t.Element=2]="Element",t[t.Text=3]="Text",t[t.CDATA=4]="CDATA",t[t.Comment=5]="Comment"})(k||(k={}));class es{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var n;if(!e)return-1;const r=(n=this.getMeta(e))===null||n===void 0?void 0:n.id;return r??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){const r=n.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,n)}replace(e,n){const r=this.getNode(e);if(r){const o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function ts(){return new es}function ns(t){const e={},n=/;(?![^(]*\))/g,r=/:(.+)/,o=/\/\*.*?\*\//g;return t.replace(o,"").split(n).forEach(function(a){if(a){const i=a.split(r);i.length>1&&(e[Rt(i[0].trim())]=i[1].trim())}}),e}function Un(t){const e=[];for(const n in t){const r=t[n];if(typeof r!="string")continue;const o=is(n);e.push(`${o}: ${r};`)}return e.join(" ")}const rs=/-([a-z])/g,os=/^--[a-zA-Z0-9-]+$/,Rt=t=>os.test(t)?t:t.replace(rs,(e,n)=>n?n.toUpperCase():""),ss=/\B([A-Z])/g,is=t=>t.replace(ss,"-$1").toLowerCase();class ne{constructor(...e){this.parentElement=null,this.parentNode=null,this.firstChild=null,this.lastChild=null,this.previousSibling=null,this.nextSibling=null,this.ELEMENT_NODE=W.ELEMENT_NODE,this.TEXT_NODE=W.TEXT_NODE}get childNodes(){const e=[];let n=this.firstChild;for(;n;)e.push(n),n=n.nextSibling;return e}contains(e){if(e instanceof ne){if(e.ownerDocument!==this.ownerDocument)return!1;if(e===this)return!0}else return!1;for(;e.parentNode;){if(e.parentNode===this)return!0;e=e.parentNode}return!1}appendChild(e){throw new Error("RRDomException: Failed to execute 'appendChild' on 'RRNode': This RRNode type does not support this method.")}insertBefore(e,n){throw new Error("RRDomException: Failed to execute 'insertBefore' on 'RRNode': This RRNode type does not support this method.")}removeChild(e){throw new Error("RRDomException: Failed to execute 'removeChild' on 'RRNode': This RRNode type does not support this method.")}toString(){return"RRNode"}}function as(t){return class yr extends t{constructor(...n){super(n),this.nodeType=W.DOCUMENT_NODE,this.nodeName="#document",this.compatMode="CSS1Compat",this.RRNodeType=k.Document,this.textContent=null,this.ownerDocument=this}get documentElement(){return this.childNodes.find(n=>n.RRNodeType===k.Element&&n.tagName==="HTML")||null}get body(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(r=>r.RRNodeType===k.Element&&r.tagName==="BODY"))||null}get head(){var n;return((n=this.documentElement)===null||n===void 0?void 0:n.childNodes.find(r=>r.RRNodeType===k.Element&&r.tagName==="HEAD"))||null}get implementation(){return this}get firstElementChild(){return this.documentElement}appendChild(n){const r=n.RRNodeType;if((r===k.Element||r===k.DocumentType)&&this.childNodes.some(a=>a.RRNodeType===r))throw new Error(`RRDomException: Failed to execute 'appendChild' on 'RRNode': Only one ${r===k.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const o=Ot(this,n);return o.parentElement=null,o}insertBefore(n,r){const o=n.RRNodeType;if((o===k.Element||o===k.DocumentType)&&this.childNodes.some(i=>i.RRNodeType===o))throw new Error(`RRDomException: Failed to execute 'insertBefore' on 'RRNode': Only one ${o===k.Element?"RRElement":"RRDoctype"} on RRDocument allowed.`);const a=Hn(this,n,r);return a.parentElement=null,a}removeChild(n){return Gn(this,n)}open(){this.firstChild=null,this.lastChild=null}close(){}write(n){let r;if(n==='<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "">'?r="-//W3C//DTD XHTML 1.0 Transitional//EN":n==='<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "">'&&(r="-//W3C//DTD HTML 4.0 Transitional//EN"),r){const o=this.createDocumentType("html",r,"");this.open(),this.appendChild(o)}}createDocument(n,r,o){return new yr}createDocumentType(n,r,o){const a=new(Wn(ne))(n,r,o);return a.ownerDocument=this,a}createElement(n){const r=new(Bn(ne))(n);return r.ownerDocument=this,r}createElementNS(n,r){return this.createElement(r)}createTextNode(n){const r=new(Vn(ne))(n);return r.ownerDocument=this,r}createComment(n){const r=new(jn(ne))(n);return r.ownerDocument=this,r}createCDATASection(n){const r=new(zn(ne))(n);return r.ownerDocument=this,r}toString(){return"RRDocument"}}}function Wn(t){return class extends t{constructor(e,n,r){super(),this.nodeType=W.DOCUMENT_TYPE_NODE,this.RRNodeType=k.DocumentType,this.name=e,this.publicId=n,this.systemId=r,this.nodeName=e,this.textContent=null}toString(){return"RRDocumentType"}}}function Bn(t){return class extends t{constructor(e){super(),this.nodeType=W.ELEMENT_NODE,this.RRNodeType=k.Element,this.attributes={},this.shadowRoot=null,this.tagName=e.toUpperCase(),this.nodeName=e.toUpperCase()}get textContent(){let e="";return this.childNodes.forEach(n=>e+=n.textContent),e}set textContent(e){this.firstChild=null,this.lastChild=null,this.appendChild(this.ownerDocument.createTextNode(e))}get classList(){return new cs(this.attributes.class,e=>{this.attributes.class=e})}get id(){return this.attributes.id||""}get className(){return this.attributes.class||""}get style(){const e=this.attributes.style?ns(this.attributes.style):{},n=/\B([A-Z])/g;return e.setProperty=(r,o,a)=>{if(n.test(r))return;const i=Rt(r);o?e[i]=o:delete e[i],a==="important"&&(e[i]+=" !important"),this.attributes.style=Un(e)},e.removeProperty=r=>{if(n.test(r))return"";const o=Rt(r),a=e[o]||"";return delete e[o],this.attributes.style=Un(e),a},e}getAttribute(e){return this.attributes[e]||null}setAttribute(e,n){this.attributes[e]=n}setAttributeNS(e,n,r){this.setAttribute(n,r)}removeAttribute(e){delete this.attributes[e]}appendChild(e){return Ot(this,e)}insertBefore(e,n){return Hn(this,e,n)}removeChild(e){return Gn(this,e)}attachShadow(e){const n=this.ownerDocument.createElement("SHADOWROOT");return this.shadowRoot=n,n}dispatchEvent(e){return!0}toString(){let e="";for(const n in this.attributes)e+=`${n}="${this.attributes[n]}" `;return`${this.tagName} ${e}`}}}function ls(t){return class extends t{attachShadow(e){throw new Error("RRDomException: Failed to execute 'attachShadow' on 'RRElement': This RRElement does not support attachShadow")}play(){this.paused=!1}pause(){this.paused=!0}}}function Vn(t){return class extends t{constructor(e){super(),this.nodeType=W.TEXT_NODE,this.nodeName="#text",this.RRNodeType=k.Text,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRText text=${JSON.stringify(this.data)}`}}}function jn(t){return class extends t{constructor(e){super(),this.nodeType=W.COMMENT_NODE,this.nodeName="#comment",this.RRNodeType=k.Comment,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRComment text=${JSON.stringify(this.data)}`}}}function zn(t){return class extends t{constructor(e){super(),this.nodeName="#cdata-section",this.nodeType=W.CDATA_SECTION_NODE,this.RRNodeType=k.CDATA,this.data=e}get textContent(){return this.data}set textContent(e){this.data=e}toString(){return`RRCDATASection data=${JSON.stringify(this.data)}`}}}class cs{constructor(e,n){if(this.classes=[],this.add=(...r)=>{for(const o of r){const a=String(o);this.classes.indexOf(a)>=0||this.classes.push(a)}this.onChange&&this.onChange(this.classes.join(" "))},this.remove=(...r)=>{this.classes=this.classes.filter(o=>r.indexOf(o)===-1),this.onChange&&this.onChange(this.classes.join(" "))},e){const r=e.trim().split(/\s+/);this.classes.push(...r)}this.onChange=n}}function Ot(t,e){return e.parentNode&&e.parentNode.removeChild(e),t.lastChild?(t.lastChild.nextSibling=e,e.previousSibling=t.lastChild):(t.firstChild=e,e.previousSibling=null),t.lastChild=e,e.nextSibling=null,e.parentNode=t,e.parentElement=t,e.ownerDocument=t.ownerDocument,e}function Hn(t,e,n){if(!n)return Ot(t,e);if(n.parentNode!==t)throw new Error("Failed to execute 'insertBefore' on 'RRNode': The RRNode before which the new node is to be inserted is not a child of this RRNode.");return e===n||(e.parentNode&&e.parentNode.removeChild(e),e.previousSibling=n.previousSibling,n.previousSibling=e,e.nextSibling=n,e.previousSibling?e.previousSibling.nextSibling=e:t.firstChild=e,e.parentElement=t,e.parentNode=t,e.ownerDocument=t.ownerDocument),e}function Gn(t,e){if(e.parentNode!==t)throw new Error("Failed to execute 'removeChild' on 'RRNode': The RRNode to be removed is not a child of this RRNode.");return e.previousSibling?e.previousSibling.nextSibling=e.nextSibling:t.firstChild=e.nextSibling,e.nextSibling?e.nextSibling.previousSibling=e.previousSibling:t.lastChild=e.previousSibling,e.previousSibling=null,e.nextSibling=null,e.parentElement=null,e.parentNode=null,e}var W;(function(t){t[t.PLACEHOLDER=0]="PLACEHOLDER",t[t.ELEMENT_NODE=1]="ELEMENT_NODE",t[t.ATTRIBUTE_NODE=2]="ATTRIBUTE_NODE",t[t.TEXT_NODE=3]="TEXT_NODE",t[t.CDATA_SECTION_NODE=4]="CDATA_SECTION_NODE",t[t.ENTITY_REFERENCE_NODE=5]="ENTITY_REFERENCE_NODE",t[t.ENTITY_NODE=6]="ENTITY_NODE",t[t.PROCESSING_INSTRUCTION_NODE=7]="PROCESSING_INSTRUCTION_NODE",t[t.COMMENT_NODE=8]="COMMENT_NODE",t[t.DOCUMENT_NODE=9]="DOCUMENT_NODE",t[t.DOCUMENT_TYPE_NODE=10]="DOCUMENT_TYPE_NODE",t[t.DOCUMENT_FRAGMENT_NODE=11]="DOCUMENT_FRAGMENT_NODE"})(W||(W={}));const xt={svg:"http://www.w3.org/2000/svg","xlink:href":"http://www.w3.org/1999/xlink",xmlns:"http://www.w3.org/2000/xmlns/"},us={altglyph:"altGlyph",altglyphdef:"altGlyphDef",altglyphitem:"altGlyphItem",animatecolor:"animateColor",animatemotion:"animateMotion",animatetransform:"animateTransform",clippath:"clipPath",feblend:"feBlend",fecolormatrix:"feColorMatrix",fecomponenttransfer:"feComponentTransfer",fecomposite:"feComposite",feconvolvematrix:"feConvolveMatrix",fediffuselighting:"feDiffuseLighting",fedisplacementmap:"feDisplacementMap",fedistantlight:"feDistantLight",fedropshadow:"feDropShadow",feflood:"feFlood",fefunca:"feFuncA",fefuncb:"feFuncB",fefuncg:"feFuncG",fefuncr:"feFuncR",fegaussianblur:"feGaussianBlur",feimage:"feImage",femerge:"feMerge",femergenode:"feMergeNode",femorphology:"feMorphology",feoffset:"feOffset",fepointlight:"fePointLight",fespecularlighting:"feSpecularLighting",fespotlight:"feSpotLight",fetile:"feTile",feturbulence:"feTurbulence",foreignobject:"foreignObject",glyphref:"glyphRef",lineargradient:"linearGradient",radialgradient:"radialGradient"};let le=null;function st(t,e,n,r=e.mirror||e.ownerDocument.mirror){t=ds(t,e,n,r),Yn(t,e,n,r),hs(t,e,n)}function ds(t,e,n,r){var o;if(n.afterAppend&&!le&&(le=new WeakSet,setTimeout(()=>{le=null},0)),!At(t,e)){const a=it(e,n.mirror,r);(o=t.parentNode)===null||o===void 0||o.replaceChild(a,t),t=a}switch(e.RRNodeType){case k.Document:{if(!Oe(t,e,n.mirror,r)){const a=r.getMeta(e);a&&(n.mirror.removeNodeFromMap(t),t.close(),t.open(),n.mirror.add(t,a),le?.add(t))}break}case k.Element:{const a=t,i=e;switch(i.tagName){case"IFRAME":{const s=t.contentDocument;if(!s)break;st(s,e.contentDocument,n,r);break}}i.shadowRoot&&(a.shadowRoot||a.attachShadow({mode:"open"}),Yn(a.shadowRoot,i.shadowRoot,n,r)),ps(a,i,r);break}}return t}function hs(t,e,n){var r;switch(e.RRNodeType){case k.Document:{const o=e.scrollData;o&&n.applyScroll(o,!0);break}case k.Element:{const o=t,a=e;switch(a.scrollData&&n.applyScroll(a.scrollData,!0),a.inputData&&n.applyInput(a.inputData),a.tagName){case"AUDIO":case"VIDEO":{const i=t,s=a;s.paused!==void 0&&(s.paused?i.pause():i.play()),s.muted!==void 0&&(i.muted=s.muted),s.volume!==void 0&&(i.volume=s.volume),s.currentTime!==void 0&&(i.currentTime=s.currentTime),s.playbackRate!==void 0&&(i.playbackRate=s.playbackRate),s.loop!==void 0&&(i.loop=s.loop);break}case"CANVAS":{const i=e;if(i.rr_dataURL!==null){const s=document.createElement("img");s.onload=()=>{const l=o.getContext("2d");l&&l.drawImage(s,0,0,s.width,s.height)},s.src=i.rr_dataURL}i.canvasMutations.forEach(s=>n.applyCanvas(s.event,s.mutation,t));break}case"STYLE":{const i=o.sheet;i&&e.rules.forEach(s=>n.applyStyleSheetMutation(s,i));break}}break}case k.Text:case k.Comment:case k.CDATA:{t.textContent!==e.data&&(t.textContent=e.data);break}}le!=null&&le.has(t)&&(le.delete(t),(r=n.afterAppend)===null||r===void 0||r.call(n,t,n.mirror.getId(t)))}function ps(t,e,n){const r=t.attributes,o=e.attributes;for(const a in o){const i=o[a],s=n.getMeta(e);if(s?.isSVG&&xt[a])t.setAttributeNS(xt[a],a,i);else if(e.tagName==="CANVAS"&&a==="rr_dataURL"){const l=document.createElement("img");l.src=i,l.onload=()=>{const c=t.getContext("2d");c&&c.drawImage(l,0,0,l.width,l.height)}}else{if(e.tagName==="IFRAME"&&a==="srcdoc")continue;t.setAttribute(a,i)}}for(const{name:a}of Array.from(r))a in o||t.removeAttribute(a);e.scrollLeft&&(t.scrollLeft=e.scrollLeft),e.scrollTop&&(t.scrollTop=e.scrollTop)}function Yn(t,e,n,r){const o=Array.from(t.childNodes),a=e.childNodes;if(o.length===0&&a.length===0)return;let i=0,s=o.length-1,l=0,c=a.length-1,u=o[i],d=o[s],h=a[l],m=a[c],y,p;for(;i<=s&&l<=c;)if(u===void 0)u=o[++i];else if(d===void 0)d=o[--s];else if(Oe(u,h,n.mirror,r))u=o[++i],h=a[++l];else if(Oe(d,m,n.mirror,r))d=o[--s],m=a[--c];else if(Oe(u,m,n.mirror,r)){try{t.insertBefore(u,d.nextSibling)}catch(S){console.warn(S)}u=o[++i],m=a[--c]}else if(Oe(d,h,n.mirror,r)){try{t.insertBefore(d,u)}catch(S){console.warn(S)}d=o[--s],h=a[++l]}else{if(!y){y={};for(let g=i;g<=s;g++){const w=o[g];w&&n.mirror.hasNode(w)&&(y[n.mirror.getId(w)]=g)}}p=y[r.getId(h)];const S=o[p];if(p!==void 0&&S&&Oe(S,h,n.mirror,r)){try{t.insertBefore(S,u)}catch(g){console.warn(g)}o[p]=void 0}else{const g=it(h,n.mirror,r);t.nodeName==="#document"&&u&&(g.nodeType===g.DOCUMENT_TYPE_NODE&&u.nodeType===u.DOCUMENT_TYPE_NODE||g.nodeType===g.ELEMENT_NODE&&u.nodeType===u.ELEMENT_NODE)&&(t.removeChild(u),n.mirror.removeNodeFromMap(u),u=o[++i]);try{t.insertBefore(g,u||null)}catch(w){console.warn(w)}}h=a[++l]}if(i>s){const S=a[c+1];let g=null;for(S&&(g=n.mirror.getNode(r.getId(S)));l<=c;++l){const w=it(a[l],n.mirror,r);try{t.insertBefore(w,g)}catch(I){console.warn(I)}}}else if(l>c)for(;i<=s;i++){const S=o[i];if(!(!S||S.parentNode!==t))try{t.removeChild(S),n.mirror.removeNodeFromMap(S)}catch(g){console.warn(g)}}let v=t.firstChild,f=e.firstChild;for(;v!==null&&f!==null;)st(v,f,n,r),v=v.nextSibling,f=f.nextSibling}function it(t,e,n){const r=n.getId(t),o=n.getMeta(t);let a=null;if(r>-1&&(a=e.getNode(r)),a!==null&&At(a,t))return a;switch(t.RRNodeType){case k.Document:a=new Document;break;case k.DocumentType:a=document.implementation.createDocumentType(t.name,t.publicId,t.systemId);break;case k.Element:{let i=t.tagName.toLowerCase();i=us[i]||i,o&&"isSVG"in o&&o?.isSVG?a=document.createElementNS(xt.svg,i):a=document.createElement(t.tagName);break}case k.Text:a=document.createTextNode(t.data);break;case k.Comment:a=document.createComment(t.data);break;case k.CDATA:a=document.createCDATASection(t.data);break}o&&e.add(a,Object.assign({},o));try{le?.add(a)}catch{}return a}function At(t,e){return t.nodeType!==e.nodeType?!1:t.nodeType!==t.ELEMENT_NODE||t.tagName.toUpperCase()===e.tagName}function Oe(t,e,n,r){const o=n.getId(t),a=r.getId(e);return o===-1||o!==a?!1:At(t,e)}class xe extends as(ne){get unserializedId(){return this._unserializedId--}constructor(e){super(),this.UNSERIALIZED_STARTING_ID=-2,this._unserializedId=this.UNSERIALIZED_STARTING_ID,this.mirror=Cs(),this.scrollData=null,e&&(this.mirror=e)}createDocument(e,n,r){return new xe}createDocumentType(e,n,r){const o=new ms(e,n,r);return o.ownerDocument=this,o}createElement(e){const n=e.toUpperCase();let r;switch(n){case"AUDIO":case"VIDEO":r=new fs(n);break;case"IFRAME":r=new vs(n,this.mirror);break;case"CANVAS":r=new ys(n);break;case"STYLE":r=new gs(n);break;default:r=new He(n);break}return r.ownerDocument=this,r}createComment(e){const n=new bs(e);return n.ownerDocument=this,n}createCDATASection(e){const n=new ws(e);return n.ownerDocument=this,n}createTextNode(e){const n=new Ss(e);return n.ownerDocument=this,n}destroyTree(){this.firstChild=null,this.lastChild=null,this.mirror.reset()}open(){super.open(),this._unserializedId=this.UNSERIALIZED_STARTING_ID}}const ms=Wn(ne);class He extends Bn(ne){constructor(){super(...arguments),this.inputData=null,this.scrollData=null}}class fs extends ls(He){}class ys extends He{constructor(){super(...arguments),this.rr_dataURL=null,this.canvasMutations=[]}getContext(){return null}}class gs extends He{constructor(){super(...arguments),this.rules=[]}}class vs extends He{constructor(e,n){super(e),this.contentDocument=new xe,this.contentDocument.mirror=n}}const Ss=Vn(ne),bs=jn(ne),ws=zn(ne);function Ms(t){return t instanceof HTMLFormElement?"FORM":t.tagName.toUpperCase()}function Xn(t,e,n,r){let o;switch(t.nodeType){case W.DOCUMENT_NODE:r&&r.nodeName==="IFRAME"?o=r.contentDocument:(o=e,o.compatMode=t.compatMode);break;case W.DOCUMENT_TYPE_NODE:{const i=t;o=e.createDocumentType(i.name,i.publicId,i.systemId);break}case W.ELEMENT_NODE:{const i=t,s=Ms(i);o=e.createElement(s);const l=o;for(const{name:c,value:u}of Array.from(i.attributes))l.attributes[c]=u;i.scrollLeft&&(l.scrollLeft=i.scrollLeft),i.scrollTop&&(l.scrollTop=i.scrollTop);break}case W.TEXT_NODE:o=e.createTextNode(t.textContent||"");break;case W.CDATA_SECTION_NODE:o=e.createCDATASection(t.data);break;case W.COMMENT_NODE:o=e.createComment(t.textContent||"");break;case W.DOCUMENT_FRAGMENT_NODE:o=r.attachShadow({mode:"open"});break;default:return null}let a=n.getMeta(t);return e instanceof xe&&(a||(a=qn(o,e.unserializedId),n.add(t,a)),e.mirror.add(o,Object.assign({},a))),o}function Es(t,e=ts(),n=new xe){function r(o,a){const i=Xn(o,n,e,a);if(i!==null)if(a?.nodeName!=="IFRAME"&&o.nodeType!==W.DOCUMENT_FRAGMENT_NODE&&(a?.appendChild(i),i.parentNode=a,i.parentElement=a),o.nodeName==="IFRAME"){const s=o.contentDocument;s&&r(s,i)}else(o.nodeType===W.DOCUMENT_NODE||o.nodeType===W.ELEMENT_NODE||o.nodeType===W.DOCUMENT_FRAGMENT_NODE)&&(o.nodeType===W.ELEMENT_NODE&&o.shadowRoot&&r(o.shadowRoot,i),o.childNodes.forEach(s=>r(s,i)))}return r(t,null),n}function Cs(){return new Ts}class Ts{constructor(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}getId(e){var n;if(!e)return-1;const r=(n=this.getMeta(e))===null||n===void 0?void 0:n.id;return r??-1}getNode(e){return this.idNodeMap.get(e)||null}getIds(){return Array.from(this.idNodeMap.keys())}getMeta(e){return this.nodeMetaMap.get(e)||null}removeNodeFromMap(e){const n=this.getId(e);this.idNodeMap.delete(n),e.childNodes&&e.childNodes.forEach(r=>this.removeNodeFromMap(r))}has(e){return this.idNodeMap.has(e)}hasNode(e){return this.nodeMetaMap.has(e)}add(e,n){const r=n.id;this.idNodeMap.set(r,e),this.nodeMetaMap.set(e,n)}replace(e,n){const r=this.getNode(e);if(r){const o=this.nodeMetaMap.get(r);o&&this.nodeMetaMap.set(n,o)}this.idNodeMap.set(e,n)}reset(){this.idNodeMap=new Map,this.nodeMetaMap=new WeakMap}}function qn(t,e){switch(t.RRNodeType){case k.Document:return{id:e,type:t.RRNodeType,childNodes:[]};case k.DocumentType:{const n=t;return{id:e,type:t.RRNodeType,name:n.name,publicId:n.publicId,systemId:n.systemId}}case k.Element:return{id:e,type:t.RRNodeType,tagName:t.tagName.toLowerCase(),attributes:{},childNodes:[]};case k.Text:return{id:e,type:t.RRNodeType,textContent:t.textContent||""};case k.Comment:return{id:e,type:t.RRNodeType,textContent:t.textContent||""};case k.CDATA:return{id:e,type:t.RRNodeType,textContent:""}}}function Qn(t){return{all:t=t||new Map,on:function(e,n){var r=t.get(e);r?r.push(n):t.set(e,[n])},off:function(e,n){var r=t.get(e);r&&(n?r.splice(r.indexOf(n)>>>0,1):t.set(e,[]))},emit:function(e,n){var r=t.get(e);r&&r.slice().map(function(o){o(n)}),(r=t.get("*"))&&r.slice().map(function(o){o(e,n)})}}}var Is=Object.freeze({__proto__:null,default:Qn});function Ns(t=window,e=document){if("scrollBehavior"in e.documentElement.style&&t.__forceSmoothScrollPolyfill__!==!0)return;const n=t.HTMLElement||t.Element,r=468,o={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,elementScroll:n.prototype.scroll||l,scrollIntoView:n.prototype.scrollIntoView},a=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now;function i(f){const S=["MSIE ","Trident/","Edge/"];return new RegExp(S.join("|")).test(f)}const s=i(t.navigator.userAgent)?1:0;function l(f,S){this.scrollLeft=f,this.scrollTop=S}function c(f){return .5*(1-Math.cos(Math.PI*f))}function u(f){if(f===null||typeof f!="object"||f.behavior===void 0||f.behavior==="auto"||f.behavior==="instant")return!0;if(typeof f=="object"&&f.behavior==="smooth")return!1;throw new TypeError("behavior member of ScrollOptions "+f.behavior+" is not a valid value for enumeration ScrollBehavior.")}function d(f,S){if(S==="Y")return f.clientHeight+s<f.scrollHeight;if(S==="X")return f.clientWidth+s<f.scrollWidth}function h(f,S){const g=t.getComputedStyle(f,null)["overflow"+S];return g==="auto"||g==="scroll"}function m(f){const S=d(f,"Y")&&h(f,"Y"),g=d(f,"X")&&h(f,"X");return S||g}function y(f){for(;f!==e.body&&m(f)===!1;)f=f.parentNode||f.host;return f}function p(f){const S=a();let g,w,I,L=(S-f.startTime)/r;L=L>1?1:L,g=c(L),w=f.startX+(f.x-f.startX)*g,I=f.startY+(f.y-f.startY)*g,f.method.call(f.scrollable,w,I),(w!==f.x||I!==f.y)&&t.requestAnimationFrame(p.bind(t,f))}function v(f,S,g){let w,I,L,j;const z=a();f===e.body?(w=t,I=t.scrollX||t.pageXOffset,L=t.scrollY||t.pageYOffset,j=o.scroll):(w=f,I=f.scrollLeft,L=f.scrollTop,j=l),p({scrollable:w,method:j,startTime:z,startX:I,startY:L,x:S,y:g})}t.scroll=t.scrollTo=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){o.scroll.call(t,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:t.scrollX||t.pageXOffset,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:t.scrollY||t.pageYOffset);return}v.call(t,e.body,arguments[0].left!==void 0?~~arguments[0].left:t.scrollX||t.pageXOffset,arguments[0].top!==void 0?~~arguments[0].top:t.scrollY||t.pageYOffset)}},t.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])){o.scrollBy.call(t,arguments[0].left!==void 0?arguments[0].left:typeof arguments[0]!="object"?arguments[0]:0,arguments[0].top!==void 0?arguments[0].top:arguments[1]!==void 0?arguments[1]:0);return}v.call(t,e.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset))}},n.prototype.scroll=n.prototype.scrollTo=function(){if(arguments[0]===void 0)return;if(u(arguments[0])===!0){if(typeof arguments[0]=="number"&&arguments[1]===void 0)throw new SyntaxError("Value could not be converted");o.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left:typeof arguments[0]!="object"?~~arguments[0]:this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top:arguments[1]!==void 0?~~arguments[1]:this.scrollTop);return}const f=arguments[0].left,S=arguments[0].top;v.call(this,this,typeof f>"u"?this.scrollLeft:~~f,typeof S>"u"?this.scrollTop:~~S)},n.prototype.scrollBy=function(){if(arguments[0]!==void 0){if(u(arguments[0])===!0){o.elementScroll.call(this,arguments[0].left!==void 0?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,arguments[0].top!==void 0?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop);return}this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior})}},n.prototype.scrollIntoView=function(){if(u(arguments[0])===!0){o.scrollIntoView.call(this,arguments[0]===void 0?!0:arguments[0]);return}const f=y(this),S=f.getBoundingClientRect(),g=this.getBoundingClientRect();f!==e.body?(v.call(this,f,f.scrollLeft+g.left-S.left,f.scrollTop+g.top-S.top),t.getComputedStyle(f).position!=="fixed"&&t.scrollBy({left:S.left,top:S.top,behavior:"smooth"})):t.scrollBy({left:g.left,top:g.top,behavior:"smooth"})}}class Ds{constructor(e=[],n){this.timeOffset=0,this.raf=null,this.actions=e,this.speed=n.speed}addAction(e){const n=this.raf===!0;if(!this.actions.length||this.actions[this.actions.length-1].delay<=e.delay)this.actions.push(e);else{const r=this.findActionIndex(e);this.actions.splice(r,0,e)}n&&(this.raf=requestAnimationFrame(this.rafCheck.bind(this)))}start(){this.timeOffset=0,this.lastTimestamp=performance.now(),this.raf=requestAnimationFrame(this.rafCheck.bind(this))}rafCheck(){const e=performance.now();for(this.timeOffset+=(e-this.lastTimestamp)*this.speed,this.lastTimestamp=e;this.actions.length;){const n=this.actions[0];if(this.timeOffset>=n.delay)this.actions.shift(),n.doAction();else break}this.actions.length>0?this.raf=requestAnimationFrame(this.rafCheck.bind(this)):this.raf=!0}clear(){this.raf&&(this.raf!==!0&&cancelAnimationFrame(this.raf),this.raf=null),this.actions.length=0}setSpeed(e){this.speed=e}isActive(){return this.raf!==null}findActionIndex(e){let n=0,r=this.actions.length-1;for(;n<=r;){const o=Math.floor((n+r)/2);if(this.actions[o].delay<e.delay)n=o+1;else if(this.actions[o].delay>e.delay)r=o-1;else return o+1}return n}}function Jn(t,e){if(t.type===C.IncrementalSnapshot&&t.data.source===E.MouseMove&&t.data.positions&&t.data.positions.length){const n=t.data.positions[0].timeOffset,r=t.timestamp+n;return t.delay=r-e,r-e}return t.delay=t.timestamp-e,t.delay}/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function Kn(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var r,o,a=n.call(t),i=[];try{for(;(e===void 0||e-- >0)&&!(r=a.next()).done;)i.push(r.value)}catch(s){o={error:s}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(o)throw o.error}}return i}var Ae;(function(t){t[t.NotStarted=0]="NotStarted",t[t.Running=1]="Running",t[t.Stopped=2]="Stopped"})(Ae||(Ae={}));var Zn={type:"xstate.init"};function Lt(t){return t===void 0?[]:[].concat(t)}function Le(t){return{type:"xstate.assign",assignment:t}}function er(t,e){return typeof(t=typeof t=="string"&&e&&e[t]?e[t]:t)=="string"?{type:t}:typeof t=="function"?{type:t.name,exec:t}:t}function at(t){return function(e){return t===e}}function tr(t){return typeof t=="string"?{type:t}:t}function nr(t,e){return{value:t,context:e,actions:[],changed:!1,matches:at(t)}}function rr(t,e,n){var r=e,o=!1;return[t.filter(function(a){if(a.type==="xstate.assign"){o=!0;var i=Object.assign({},r);return typeof a.assignment=="function"?i=a.assignment(r,n):Object.keys(a.assignment).forEach(function(s){i[s]=typeof a.assignment[s]=="function"?a.assignment[s](r,n):a.assignment[s]}),r=i,!1}return!0}),r,o]}function or(t,e){e===void 0&&(e={});var n=Kn(rr(Lt(t.states[t.initial].entry).map(function(i){return er(i,e.actions)}),t.context,Zn),2),r=n[0],o=n[1],a={config:t,_options:e,initialState:{value:t.initial,actions:r,context:o,matches:at(t.initial)},transition:function(i,s){var l,c,u=typeof i=="string"?{value:i,context:t.context}:i,d=u.value,h=u.context,m=tr(s),y=t.states[d];if(y.on){var p=Lt(y.on[m.type]);try{for(var v=function(F){var de=typeof Symbol=="function"&&Symbol.iterator,ve=de&&F[de],M=0;if(ve)return ve.call(F);if(F&&typeof F.length=="number")return{next:function(){return F&&M>=F.length&&(F=void 0),{value:F&&F[M++],done:!F}}};throw new TypeError(de?"Object is not iterable.":"Symbol.iterator is not defined.")}(p),f=v.next();!f.done;f=v.next()){var S=f.value;if(S===void 0)return nr(d,h);var g=typeof S=="string"?{target:S}:S,w=g.target,I=g.actions,L=I===void 0?[]:I,j=g.cond,z=j===void 0?function(){return!0}:j,Q=w===void 0,J=w??d,re=t.states[J];if(z(h,m)){var R=Kn(rr((Q?Lt(L):[].concat(y.exit,L,re.entry).filter(function(F){return F})).map(function(F){return er(F,a._options.actions)}),h,m),3),oe=R[0],H=R[1],se=R[2],K=w??d;return{value:K,context:H,actions:oe,changed:w!==d||oe.length>0||se,matches:at(K)}}}}catch(F){l={error:F}}finally{try{f&&!f.done&&(c=v.return)&&c.call(v)}finally{if(l)throw l.error}}}return nr(d,h)}};return a}var sr=function(t,e){return t.actions.forEach(function(n){var r=n.exec;return r&&r(t.context,e)})};function ir(t){var e=t.initialState,n=Ae.NotStarted,r=new Set,o={_machine:t,send:function(a){n===Ae.Running&&(e=t.transition(e,a),sr(e,tr(a)),r.forEach(function(i){return i(e)}))},subscribe:function(a){return r.add(a),a(e),{unsubscribe:function(){return r.delete(a)}}},start:function(a){if(a){var i=typeof a=="object"?a:{context:t.config.context,value:a};e={value:i.value,actions:[],context:i.context,matches:at(i.value)}}return n=Ae.Running,sr(e,Zn),o},stop:function(){return n=Ae.Stopped,r.clear(),o},get state(){return e},get status(){return n}};return o}var ks=Object.defineProperty,Rs=Object.defineProperties,Os=Object.getOwnPropertyDescriptors,ar=Object.getOwnPropertySymbols,xs=Object.prototype.hasOwnProperty,As=Object.prototype.propertyIsEnumerable,lr=(t,e,n)=>e in t?ks(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,_t=(t,e)=>{for(var n in e||(e={}))xs.call(e,n)&&lr(t,n,e[n]);if(ar)for(var n of ar(e))As.call(e,n)&&lr(t,n,e[n]);return t},Ft=(t,e)=>Rs(t,Os(e));function Ls(t,e){for(let n=t.length-1;n>=0;n--){const r=t[n];if(r.type===C.Meta&&r.timestamp<=e)return t.slice(n)}return t}function _s(t,{getCastFn:e,applyEventsSynchronously:n,emitter:r}){const o=or({id:"player",context:t,initial:"paused",states:{playing:{on:{PAUSE:{target:"paused",actions:["pause"]},CAST_EVENT:{target:"playing",actions:"castEvent"},END:{target:"paused",actions:["resetLastPlayedEvent","pause"]},ADD_EVENT:{target:"playing",actions:["addEvent"]}}},paused:{on:{PLAY:{target:"playing",actions:["recordTimeOffset","play"]},CAST_EVENT:{target:"paused",actions:"castEvent"},TO_LIVE:{target:"live",actions:["startLive"]},ADD_EVENT:{target:"paused",actions:["addEvent"]}}},live:{on:{ADD_EVENT:{target:"live",actions:["addEvent"]},CAST_EVENT:{target:"live",actions:["castEvent"]}}}}},{actions:{castEvent:Le({lastPlayedEvent:(a,i)=>i.type==="CAST_EVENT"?i.payload.event:a.lastPlayedEvent}),recordTimeOffset:Le((a,i)=>{let s=a.timeOffset;return"payload"in i&&"timeOffset"in i.payload&&(s=i.payload.timeOffset),Ft(_t({},a),{timeOffset:s,baselineTime:a.events[0].timestamp+s})}),play(a){var i;const{timer:s,events:l,baselineTime:c,lastPlayedEvent:u}=a;s.clear();for(const y of l)Jn(y,c);const d=Ls(l,c);let h=u?.timestamp;u?.type===C.IncrementalSnapshot&&u.data.source===E.MouseMove&&(h=u.timestamp+((i=u.data.positions[0])==null?void 0:i.timeOffset)),c<(h||0)&&r.emit(O.PlayBack);const m=new Array;for(const y of d)if(!(h&&h<c&&(y.timestamp<=h||y===u)))if(y.timestamp<c)m.push(y);else{const p=e(y,!1);s.addAction({doAction:()=>{p()},delay:y.delay})}n(m),r.emit(O.Flush),s.start()},pause(a){a.timer.clear()},resetLastPlayedEvent:Le(a=>Ft(_t({},a),{lastPlayedEvent:null})),startLive:Le({baselineTime:(a,i)=>(a.timer.start(),i.type==="TO_LIVE"&&i.payload.baselineTime?i.payload.baselineTime:Date.now())}),addEvent:Le((a,i)=>{const{baselineTime:s,timer:l,events:c}=a;if(i.type==="ADD_EVENT"){const{event:u}=i.payload;Jn(u,s);let d=c.length-1;if(!c[d]||c[d].timestamp<=u.timestamp)c.push(u);else{let y=-1,p=0;for(;p<=d;){const v=Math.floor((p+d)/2);c[v].timestamp<=u.timestamp?p=v+1:d=v-1}y===-1&&(y=p),c.splice(y,0,u)}const h=u.timestamp<s,m=e(u,h);h?m():l.isActive()&&l.addAction({doAction:()=>{m()},delay:u.delay})}return Ft(_t({},a),{events:c})})}});return ir(o)}function Fs(t){const e=or({id:"speed",context:t,initial:"normal",states:{normal:{on:{FAST_FORWARD:{target:"skipping",actions:["recordSpeed","setSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}},skipping:{on:{BACK_TO_NORMAL:{target:"normal",actions:["restoreSpeed"]},SET_SPEED:{target:"normal",actions:["setSpeed"]}}}}},{actions:{setSpeed:(n,r)=>{"payload"in r&&n.timer.setSpeed(r.payload.speed)},recordSpeed:Le({normalSpeed:n=>n.timer.speed}),restoreSpeed:n=>{n.timer.setSpeed(n.normalSpeed)}}});return ir(e)}const Ps=t=>[`.${t} { background: currentColor }`,"noscript { display: none !important; }"];var $s=(t,e,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(t,e)).next())});const cr=new Map;function ur(t,e){let n=cr.get(t);return n||(n=new Map,cr.set(t,n)),n.has(e)||n.set(e,[]),n.get(e)}function ge(t,e,n){return r=>$s(this,null,function*(){if(r&&typeof r=="object"&&"rr_type"in r)if(n&&(n.isUnchanged=!1),r.rr_type==="ImageBitmap"&&"args"in r){const o=yield ge(t,e,n)(r.args);return yield createImageBitmap.apply(null,o)}else if("index"in r){if(n||e===null)return r;const{rr_type:o,index:a}=r;return ur(e,o)[a]}else if("args"in r){const{rr_type:o,args:a}=r,i=window[o];return new i(...yield Promise.all(a.map(ge(t,e,n))))}else{if("base64"in r)return xo(r.base64);if("src"in r){const o=t.get(r.src);if(o)return o;{const a=new Image;return a.src=r.src,t.set(r.src,a),a}}else if("data"in r&&r.rr_type==="Blob"){const o=yield Promise.all(r.data.map(ge(t,e,n)));return new Blob(o,{type:r.type})}}else if(Array.isArray(r))return yield Promise.all(r.map(ge(t,e,n)));return r})}var Us=(t,e,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(t,e)).next())});function Ws(t,e){try{return e===ue.WebGL?t.getContext("webgl")||t.getContext("experimental-webgl"):t.getContext("webgl2")}catch{return null}}const Bs=["WebGLActiveInfo","WebGLBuffer","WebGLFramebuffer","WebGLProgram","WebGLRenderbuffer","WebGLShader","WebGLShaderPrecisionFormat","WebGLTexture","WebGLUniformLocation","WebGLVertexArrayObject"];function Vs(t,e){if(!(e!=null&&e.constructor))return;const{name:n}=e.constructor;if(!Bs.includes(n))return;const r=ur(t,n);r.includes(e)||r.push(e)}function js(t){return Us(this,arguments,function*({mutation:e,target:n,type:r,imageMap:o,errorHandler:a}){try{const i=Ws(n,r);if(!i)return;if(e.setter){i[e.property]=e.args[0];return}const s=i[e.property],l=yield Promise.all(e.args.map(ge(o,i))),c=s.apply(i,l);Vs(i,c)}catch(i){a(e,i)}})}var dr=(t,e,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(t,e)).next())});function zs(t){return dr(this,arguments,function*({event:e,mutations:n,target:r,imageMap:o,errorHandler:a}){const i=r.getContext("2d");if(!i){a(n[0],new Error("Canvas context is null"));return}const s=n.map(l=>dr(this,null,function*(){return Promise.all(l.args.map(ge(o,i)))}));(yield Promise.all(s)).forEach((l,c)=>{const u=n[c];try{if(u.setter){i[u.property]=u.args[0];return}const d=i[u.property];u.property==="drawImage"&&typeof u.args[0]=="string"?(o.get(e),d.apply(i,u.args)):d.apply(i,l)}catch(d){a(u,d)}})})}var Hs=(t,e,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(t,e)).next())});function Pt(t){return Hs(this,arguments,function*({event:e,mutation:n,target:r,imageMap:o,canvasEventMap:a,errorHandler:i}){try{const s=a.get(e)||n,l="commands"in s?s.commands:[s];if([ue.WebGL,ue.WebGL2].includes(n.type)){for(let c=0;c<l.length;c++){const u=l[c];yield js({mutation:u,type:n.type,target:r,imageMap:o,errorHandler:i})}return}yield zs({event:e,mutations:l,target:r,imageMap:o,errorHandler:i})}catch(s){i(n,s)}})}class Gs{constructor(e){this.mediaMap=new Map,this.metadataCallbackMap=new Map,this.warn=e.warn,this.service=e.service,this.speedService=e.speedService,this.emitter=e.emitter,this.getCurrentTime=e.getCurrentTime,this.emitter.on(O.Start,this.start.bind(this)),this.emitter.on(O.SkipStart,this.start.bind(this)),this.emitter.on(O.Pause,this.pause.bind(this)),this.emitter.on(O.Finish,this.pause.bind(this)),this.speedService.subscribe(()=>{this.syncAllMediaElements()})}syncAllMediaElements(e={pause:!1}){this.mediaMap.forEach((n,r)=>{this.syncTargetWithState(r),e.pause&&r.pause()})}start(){this.syncAllMediaElements()}pause(){this.syncAllMediaElements({pause:!0})}seekTo({time:e,target:n,mediaState:r}){if(r.isPlaying){const o=(e-r.lastInteractionTimeOffset)/1e3*r.playbackRate,a="duration"in n&&n.duration;if(Number.isNaN(a)){this.waitForMetadata(n);return}let i=r.currentTimeAtLastInteraction+o;n.loop&&a!==!1&&(i=i%a),n.currentTime=i}else n.pause(),n.currentTime=r.currentTimeAtLastInteraction}waitForMetadata(e){if(this.metadataCallbackMap.has(e)||!("addEventListener"in e))return;const n=()=>{this.metadataCallbackMap.delete(e);const r=this.mediaMap.get(e);!r||this.seekTo({time:this.getCurrentTime(),target:e,mediaState:r})};this.metadataCallbackMap.set(e,n),e.addEventListener("loadedmetadata",n,{once:!0})}getMediaStateFromMutation({target:e,timeOffset:n,mutation:r}){var o,a,i,s,l;const c=this.mediaMap.get(e),{type:u,playbackRate:d,currentTime:h,muted:m,volume:y,loop:p}=r;return{isPlaying:u===fe.Play||u!==fe.Pause&&(c?.isPlaying||e.getAttribute("autoplay")!==null),currentTimeAtLastInteraction:(o=h??c?.currentTimeAtLastInteraction)!=null?o:0,lastInteractionTimeOffset:n,playbackRate:(a=d??c?.playbackRate)!=null?a:1,volume:(i=y??c?.volume)!=null?i:1,muted:(s=m??c?.muted)!=null?s:e.getAttribute("muted")===null,loop:(l=p??c?.loop)!=null?l:e.getAttribute("loop")===null}}syncTargetWithState(e){const n=this.mediaMap.get(e);if(!n)return;const{muted:r,loop:o,volume:a,isPlaying:i}=n,s=this.service.state.matches("paused"),l=n.playbackRate*this.speedService.state.context.timer.speed;try{this.seekTo({time:this.getCurrentTime(),target:e,mediaState:n}),e.volume!==a&&(e.volume=a),e.muted=r,e.loop=o,e.playbackRate!==l&&(e.playbackRate=l),i&&!s?e.play():e.pause()}catch(c){this.warn(`Failed to replay media interactions: ${c.message||c}`)}}addMediaElements(e,n,r){if(!["AUDIO","VIDEO"].includes(e.nodeName))return;const o=e,a=r.getMeta(o);if(!a||!("attributes"in a))return;const i=this.service.state.matches("paused"),s=a.attributes;let l=!1;s.rr_mediaState?l=s.rr_mediaState==="played":l=o.getAttribute("autoplay")!==null,l&&i&&o.pause();let c=1;typeof s.rr_mediaPlaybackRate=="number"&&(c=s.rr_mediaPlaybackRate);let u=!1;typeof s.rr_mediaMuted=="boolean"?u=s.rr_mediaMuted:u=o.getAttribute("muted")!==null;let d=!1;typeof s.rr_mediaLoop=="boolean"?d=s.rr_mediaLoop:d=o.getAttribute("loop")!==null;let h=1;typeof s.rr_mediaVolume=="number"&&(h=s.rr_mediaVolume);let m=0;typeof s.rr_mediaCurrentTime=="number"&&(m=s.rr_mediaCurrentTime),this.mediaMap.set(o,{isPlaying:l,currentTimeAtLastInteraction:m,lastInteractionTimeOffset:n,playbackRate:c,volume:h,muted:u,loop:d}),this.syncTargetWithState(o)}mediaMutation({target:e,timeOffset:n,mutation:r}){this.mediaMap.set(e,this.getMediaStateFromMutation({target:e,timeOffset:n,mutation:r})),this.syncTargetWithState(e)}isSupportedMediaElement(e){return["AUDIO","VIDEO"].includes(e.nodeName)}reset(){this.mediaMap.clear()}}var Ys=Object.defineProperty,Xs=Object.defineProperties,qs=Object.getOwnPropertyDescriptors,hr=Object.getOwnPropertySymbols,Qs=Object.prototype.hasOwnProperty,Js=Object.prototype.propertyIsEnumerable,pr=(t,e,n)=>e in t?Ys(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,lt=(t,e)=>{for(var n in e||(e={}))Qs.call(e,n)&&pr(t,n,e[n]);if(hr)for(var n of hr(e))Js.call(e,n)&&pr(t,n,e[n]);return t},$t=(t,e)=>Xs(t,qs(e)),Ut=(t,e,n)=>new Promise((r,o)=>{var a=l=>{try{s(n.next(l))}catch(c){o(c)}},i=l=>{try{s(n.throw(l))}catch(c){o(c)}},s=l=>l.done?r(l.value):Promise.resolve(l.value).then(a,i);s((n=n.apply(t,e)).next())});const Ks=5*1e3,Zs=Qn||Is,mr="[replayer]",Wt={duration:500,lineCap:"round",lineWidth:3,strokeStyle:"red"};function fr(t){return t.type==C.IncrementalSnapshot&&(t.data.source==E.TouchMove||t.data.source==E.MouseInteraction&&t.data.type==A.TouchStart)}class ei{constructor(e,n){if(this.usingVirtualDom=!1,this.virtualDom=new xe,this.mouseTail=null,this.tailPositions=[],this.emitter=Zs(),this.legacy_missingNodeRetryMap={},this.cache=sn(),this.imageMap=new Map,this.canvasEventMap=new Map,this.mirror=Ht(),this.styleMirror=new Tt,this.firstFullSnapshot=null,this.newDocumentQueue=[],this.mousePos=null,this.touchActive=null,this.lastMouseDownEvent=null,this.lastSelectionData=null,this.constructedStyleMutations=[],this.adoptedStyleSheets=[],this.handleResize=s=>{this.iframe.style.display="inherit";for(const l of[this.mouseTail,this.iframe])!l||(l.setAttribute("width",String(s.width)),l.setAttribute("height",String(s.height)))},this.applyEventsSynchronously=s=>{for(const l of s){switch(l.type){case C.DomContentLoaded:case C.Load:case C.Custom:continue;case C.FullSnapshot:case C.Meta:case C.Plugin:case C.IncrementalSnapshot:break}this.getCastFn(l,!0)()}},this.getCastFn=(s,l=!1)=>{let c;switch(s.type){case C.DomContentLoaded:case C.Load:break;case C.Custom:c=()=>{this.emitter.emit(O.CustomEvent,s)};break;case C.Meta:c=()=>this.emitter.emit(O.Resize,{width:s.data.width,height:s.data.height});break;case C.FullSnapshot:c=()=>{var u;if(this.firstFullSnapshot){if(this.firstFullSnapshot===s){this.firstFullSnapshot=!0;return}}else this.firstFullSnapshot=!0;this.mediaManager.reset(),this.styleMirror.reset(),this.rebuildFullSnapshot(s,l),(u=this.iframe.contentWindow)==null||u.scrollTo(s.data.initialOffset)};break;case C.IncrementalSnapshot:c=()=>{if(this.applyIncremental(s,l),!l&&(s===this.nextUserInteractionEvent&&(this.nextUserInteractionEvent=null,this.backToNormal()),this.config.skipInactive&&!this.nextUserInteractionEvent)){for(const u of this.service.state.context.events)if(!(u.timestamp<=s.timestamp)&&this.isUserInteraction(u)){u.delay-s.delay>this.config.inactivePeriodThreshold*this.speedService.state.context.timer.speed&&(this.nextUserInteractionEvent=u);break}if(this.nextUserInteractionEvent){const u=this.nextUserInteractionEvent.delay-s.delay,d={speed:Math.min(Math.round(u/Ks),this.config.maxSpeed)};this.speedService.send({type:"FAST_FORWARD",payload:d}),this.emitter.emit(O.SkipStart,d)}}};break}return()=>{c&&c();for(const d of this.config.plugins||[])d.handler&&d.handler(s,l,{replayer:this});this.service.send({type:"CAST_EVENT",payload:{event:s}});const u=this.service.state.context.events.length-1;if(!this.config.liveMode&&s===this.service.state.context.events[u]){const d=()=>{u<this.service.state.context.events.length-1||(this.backToNormal(),this.service.send("END"),this.emitter.emit(O.Finish))};let h=50;s.type===C.IncrementalSnapshot&&s.data.source===E.MouseMove&&s.data.positions.length&&(h+=Math.max(0,-s.data.positions[0].timeOffset)),setTimeout(d,h)}this.emitter.emit(O.EventCast,s)}},!(n!=null&&n.liveMode)&&e.length<2)throw new Error("Replayer need at least 2 events.");const r={speed:1,maxSpeed:360,root:document.body,loadTimeout:0,skipInactive:!1,inactivePeriodThreshold:10*1e3,showWarning:!0,showDebug:!1,blockClass:"rr-block",liveMode:!1,insertStyleRules:[],triggerFocus:!0,UNSAFE_replayCanvas:!1,pauseAnimation:!0,mouseTail:Wt,useVirtualDom:!0,logger:console};this.config=Object.assign({},r,n),this.handleResize=this.handleResize.bind(this),this.getCastFn=this.getCastFn.bind(this),this.applyEventsSynchronously=this.applyEventsSynchronously.bind(this),this.emitter.on(O.Resize,this.handleResize),this.setupDom();for(const s of this.config.plugins||[])s.getMirror&&s.getMirror({nodeMirror:this.mirror});this.emitter.on(O.Flush,()=>{if(this.usingVirtualDom){const s={mirror:this.mirror,applyCanvas:(l,c,u)=>{Pt({event:l,mutation:c,target:u,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})},applyInput:this.applyInput.bind(this),applyScroll:this.applyScroll.bind(this),applyStyleSheetMutation:(l,c)=>{l.source===E.StyleSheetRule?this.applyStyleSheetRule(l,c):l.source===E.StyleDeclaration&&this.applyStyleDeclaration(l,c)},afterAppend:(l,c)=>{for(const u of this.config.plugins||[])u.onBuild&&u.onBuild(l,{id:c,replayer:this})}};if(this.iframe.contentDocument)try{st(this.iframe.contentDocument,this.virtualDom,s,this.virtualDom.mirror)}catch(l){console.warn(l)}if(this.virtualDom.destroyTree(),this.usingVirtualDom=!1,Object.keys(this.legacy_missingNodeRetryMap).length)for(const l in this.legacy_missingNodeRetryMap)try{const c=this.legacy_missingNodeRetryMap[l],u=it(c.node,this.mirror,this.virtualDom.mirror);st(u,c.node,s,this.virtualDom.mirror),c.node=u}catch(c){this.warn(c)}this.constructedStyleMutations.forEach(l=>{this.applyStyleSheetMutation(l)}),this.constructedStyleMutations=[],this.adoptedStyleSheets.forEach(l=>{this.applyAdoptedStyleSheet(l)}),this.adoptedStyleSheets=[]}if(this.mousePos&&(this.moveAndHover(this.mousePos.x,this.mousePos.y,this.mousePos.id,!0,this.mousePos.debugData),this.mousePos=null),this.touchActive===!0?this.mouse.classList.add("touch-active"):this.touchActive===!1&&this.mouse.classList.remove("touch-active"),this.touchActive=null,this.lastMouseDownEvent){const[s,l]=this.lastMouseDownEvent;s.dispatchEvent(l)}this.lastMouseDownEvent=null,this.lastSelectionData&&(this.applySelection(this.lastSelectionData),this.lastSelectionData=null)}),this.emitter.on(O.PlayBack,()=>{this.firstFullSnapshot=null,this.mirror.reset(),this.styleMirror.reset(),this.mediaManager.reset()});const o=new Ds([],{speed:this.config.speed});this.service=_s({events:e.map(s=>n&&n.unpackFn?n.unpackFn(s):s).sort((s,l)=>s.timestamp-l.timestamp),timer:o,timeOffset:0,baselineTime:0,lastPlayedEvent:null},{getCastFn:this.getCastFn,applyEventsSynchronously:this.applyEventsSynchronously,emitter:this.emitter}),this.service.start(),this.service.subscribe(s=>{this.emitter.emit(O.StateChange,{player:s})}),this.speedService=Fs({normalSpeed:-1,timer:o}),this.speedService.start(),this.speedService.subscribe(s=>{this.emitter.emit(O.StateChange,{speed:s})}),this.mediaManager=new Gs({warn:this.warn.bind(this),service:this.service,speedService:this.speedService,emitter:this.emitter,getCurrentTime:this.getCurrentTime.bind(this)});const a=this.service.state.context.events.find(s=>s.type===C.Meta),i=this.service.state.context.events.find(s=>s.type===C.FullSnapshot);if(a){const{width:s,height:l}=a.data;setTimeout(()=>{this.emitter.emit(O.Resize,{width:s,height:l})},0)}i&&setTimeout(()=>{var s;this.firstFullSnapshot||(this.firstFullSnapshot=i,this.rebuildFullSnapshot(i),(s=this.iframe.contentWindow)==null||s.scrollTo(i.data.initialOffset))},1),this.service.state.context.events.find(fr)&&this.mouse.classList.add("touch-device")}get timer(){return this.service.state.context.timer}on(e,n){return this.emitter.on(e,n),this}off(e,n){return this.emitter.off(e,n),this}setConfig(e){Object.keys(e).forEach(n=>{e[n],this.config[n]=e[n]}),this.config.skipInactive||this.backToNormal(),typeof e.speed<"u"&&this.speedService.send({type:"SET_SPEED",payload:{speed:e.speed}}),typeof e.mouseTail<"u"&&(e.mouseTail===!1?this.mouseTail&&(this.mouseTail.style.display="none"):(this.mouseTail||(this.mouseTail=document.createElement("canvas"),this.mouseTail.width=Number.parseFloat(this.iframe.width),this.mouseTail.height=Number.parseFloat(this.iframe.height),this.mouseTail.classList.add("replayer-mouse-tail"),this.wrapper.insertBefore(this.mouseTail,this.iframe)),this.mouseTail.style.display="inherit"))}getMetaData(){const e=this.service.state.context.events[0],n=this.service.state.context.events[this.service.state.context.events.length-1];return{startTime:e.timestamp,endTime:n.timestamp,totalTime:n.timestamp-e.timestamp}}getCurrentTime(){return this.timer.timeOffset+this.getTimeOffset()}getTimeOffset(){const{baselineTime:e,events:n}=this.service.state.context;return e-n[0].timestamp}getMirror(){return this.mirror}play(e=0){var n,r;this.service.state.matches("paused")?this.service.send({type:"PLAY",payload:{timeOffset:e}}):(this.service.send({type:"PAUSE"}),this.service.send({type:"PLAY",payload:{timeOffset:e}})),(r=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||r.classList.remove("rrweb-paused"),this.emitter.emit(O.Start)}pause(e){var n,r;e===void 0&&this.service.state.matches("playing")&&this.service.send({type:"PAUSE"}),typeof e=="number"&&(this.play(e),this.service.send({type:"PAUSE"})),(r=(n=this.iframe.contentDocument)==null?void 0:n.getElementsByTagName("html")[0])==null||r.classList.add("rrweb-paused"),this.emitter.emit(O.Pause)}resume(e=0){this.warn("The 'resume' was deprecated in 1.0. Please use 'play' method which has the same interface."),this.play(e),this.emitter.emit(O.Resume)}destroy(){this.pause(),this.mirror.reset(),this.styleMirror.reset(),this.mediaManager.reset(),this.config.root.removeChild(this.wrapper),this.emitter.emit(O.Destroy)}startLive(e){this.service.send({type:"TO_LIVE",payload:{baselineTime:e}})}addEvent(e){const n=this.config.unpackFn?this.config.unpackFn(e):e;fr(n)&&this.mouse.classList.add("touch-device"),Promise.resolve().then(()=>this.service.send({type:"ADD_EVENT",payload:{event:n}}))}enableInteract(){this.iframe.setAttribute("scrolling","auto"),this.iframe.style.pointerEvents="auto"}disableInteract(){this.iframe.setAttribute("scrolling","no"),this.iframe.style.pointerEvents="none"}resetCache(){this.cache=sn()}setupDom(){this.wrapper=document.createElement("div"),this.wrapper.classList.add("replayer-wrapper"),this.config.root.appendChild(this.wrapper),this.mouse=document.createElement("div"),this.mouse.classList.add("replayer-mouse"),this.wrapper.appendChild(this.mouse),this.config.mouseTail!==!1&&(this.mouseTail=document.createElement("canvas"),this.mouseTail.classList.add("replayer-mouse-tail"),this.mouseTail.style.display="inherit",this.wrapper.appendChild(this.mouseTail)),this.iframe=document.createElement("iframe");const e=["allow-same-origin"];this.config.UNSAFE_replayCanvas&&e.push("allow-scripts"),this.iframe.style.display="none",this.iframe.setAttribute("sandbox",e.join(" ")),this.disableInteract(),this.wrapper.appendChild(this.iframe),this.iframe.contentWindow&&this.iframe.contentDocument&&(Ns(this.iframe.contentWindow,this.iframe.contentDocument),bt(this.iframe.contentWindow))}rebuildFullSnapshot(e,n=!1){if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");Object.keys(this.legacy_missingNodeRetryMap).length&&this.warn("Found unresolved missing node map",this.legacy_missingNodeRetryMap),this.legacy_missingNodeRetryMap={};const r=[],o=(s,l)=>{if(this.collectIframeAndAttachDocument(r,s),this.mediaManager.isSupportedMediaElement(s)){const{events:c}=this.service.state.context;this.mediaManager.addMediaElements(s,e.timestamp-c[0].timestamp,this.mirror)}for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(s,{id:l,replayer:this})};this.usingVirtualDom&&(this.virtualDom.destroyTree(),this.usingVirtualDom=!1),this.mirror.reset(),Kr(e.data.node,{doc:this.iframe.contentDocument,afterAppend:o,cache:this.cache,mirror:this.mirror}),o(this.iframe.contentDocument,e.data.node.id);for(const{mutationInQueue:s,builtNode:l}of r)this.attachDocumentToIframe(s,l),this.newDocumentQueue=this.newDocumentQueue.filter(c=>c!==s);const{documentElement:a,head:i}=this.iframe.contentDocument;this.insertStyleRules(a,i),this.service.state.matches("playing")||this.iframe.contentDocument.getElementsByTagName("html")[0].classList.add("rrweb-paused"),this.emitter.emit(O.FullsnapshotRebuilded,e),n||this.waitForStylesheetLoad(),this.config.UNSAFE_replayCanvas&&this.preloadAllImages()}insertStyleRules(e,n){var r;const o=Ps(this.config.blockClass).concat(this.config.insertStyleRules);if(this.config.pauseAnimation&&o.push("html.rrweb-paused *, html.rrweb-paused *:before, html.rrweb-paused *:after { animation-play-state: paused !important; }"),this.usingVirtualDom){const a=this.virtualDom.createElement("style");this.virtualDom.mirror.add(a,qn(a,this.virtualDom.unserializedId)),e.insertBefore(a,n),a.rules.push({source:E.StyleSheetRule,adds:o.map((i,s)=>({rule:i,index:s}))})}else{const a=document.createElement("style");e.insertBefore(a,n);for(let i=0;i<o.length;i++)(r=a.sheet)==null||r.insertRule(o[i],i)}}attachDocumentToIframe(e,n){const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror,o=[],a=(i,s)=>{this.collectIframeAndAttachDocument(o,i);const l=r.getMeta(i);if(l?.type===T.Element&&l?.tagName.toUpperCase()==="HTML"){const{documentElement:c,head:u}=n.contentDocument;this.insertStyleRules(c,u)}if(!this.usingVirtualDom)for(const c of this.config.plugins||[])c.onBuild&&c.onBuild(i,{id:s,replayer:this})};Ue(e.node,{doc:n.contentDocument,mirror:r,hackCss:!0,skipChild:!1,afterAppend:a,cache:this.cache}),a(n.contentDocument,e.node.id);for(const{mutationInQueue:i,builtNode:s}of o)this.attachDocumentToIframe(i,s),this.newDocumentQueue=this.newDocumentQueue.filter(l=>l!==i)}collectIframeAndAttachDocument(e,n){if(De(n,this.mirror)){const r=this.newDocumentQueue.find(o=>o.parentId===this.mirror.getId(n));r&&e.push({mutationInQueue:r,builtNode:n})}}waitForStylesheetLoad(){var e;const n=(e=this.iframe.contentDocument)==null?void 0:e.head;if(n){const r=new Set;let o,a=this.service.state;const i=()=>{a=this.service.state};this.emitter.on(O.Start,i),this.emitter.on(O.Pause,i);const s=()=>{this.emitter.off(O.Start,i),this.emitter.off(O.Pause,i)};n.querySelectorAll('link[rel="stylesheet"]').forEach(l=>{l.sheet||(r.add(l),l.addEventListener("load",()=>{r.delete(l),r.size===0&&o!==-1&&(a.matches("playing")&&this.play(this.getCurrentTime()),this.emitter.emit(O.LoadStylesheetEnd),o&&clearTimeout(o),s())}))}),r.size>0&&(this.service.send({type:"PAUSE"}),this.emitter.emit(O.LoadStylesheetStart),o=setTimeout(()=>{a.matches("playing")&&this.play(this.getCurrentTime()),o=-1,s()},this.config.loadTimeout))}}preloadAllImages(){return Ut(this,null,function*(){this.service.state;const e=()=>{this.service.state};this.emitter.on(O.Start,e),this.emitter.on(O.Pause,e);const n=[];for(const r of this.service.state.context.events)r.type===C.IncrementalSnapshot&&r.data.source===E.CanvasMutation&&(n.push(this.deserializeAndPreloadCanvasEvents(r.data,r)),("commands"in r.data?r.data.commands:[r.data]).forEach(o=>{this.preloadImages(o,r)}));return Promise.all(n)})}preloadImages(e,n){if(e.property==="drawImage"&&typeof e.args[0]=="string"&&!this.imageMap.has(n)){const r=document.createElement("canvas"),o=r.getContext("2d"),a=o?.createImageData(r.width,r.height);a?.data,JSON.parse(e.args[0]),o?.putImageData(a,0,0)}}deserializeAndPreloadCanvasEvents(e,n){return Ut(this,null,function*(){if(!this.canvasEventMap.has(n)){const r={isUnchanged:!0};if("commands"in e){const o=yield Promise.all(e.commands.map(a=>Ut(this,null,function*(){const i=yield Promise.all(a.args.map(ge(this.imageMap,null,r)));return $t(lt({},a),{args:i})})));r.isUnchanged===!1&&this.canvasEventMap.set(n,$t(lt({},e),{commands:o}))}else{const o=yield Promise.all(e.args.map(ge(this.imageMap,null,r)));r.isUnchanged===!1&&this.canvasEventMap.set(n,$t(lt({},e),{args:o}))}}})}applyIncremental(e,n){var r,o,a;const{data:i}=e;switch(i.source){case E.Mutation:{try{this.applyMutation(i,n)}catch(s){this.warn(`Exception in mutation ${s.message||s}`,i)}break}case E.Drag:case E.TouchMove:case E.MouseMove:if(n){const s=i.positions[i.positions.length-1];this.mousePos={x:s.x,y:s.y,id:s.id,debugData:i}}else i.positions.forEach(s=>{const l={doAction:()=>{this.moveAndHover(s.x,s.y,s.id,n,i)},delay:s.timeOffset+e.timestamp-this.service.state.context.baselineTime};this.timer.addAction(l)}),this.timer.addAction({doAction(){},delay:e.delay-((r=i.positions[0])==null?void 0:r.timeOffset)});break;case E.MouseInteraction:{if(i.id===-1)break;const s=new Event(he(A[i.type])),l=this.mirror.getNode(i.id);if(!l)return this.debugNodeNotFound(i,i.id);this.emitter.emit(O.MouseInteraction,{type:i.type,target:l});const{triggerFocus:c}=this.config;switch(i.type){case A.Blur:"blur"in l&&l.blur();break;case A.Focus:c&&l.focus&&l.focus({preventScroll:!0});break;case A.Click:case A.TouchStart:case A.TouchEnd:case A.MouseDown:case A.MouseUp:n?(i.type===A.TouchStart?this.touchActive=!0:i.type===A.TouchEnd&&(this.touchActive=!1),i.type===A.MouseDown?this.lastMouseDownEvent=[l,s]:i.type===A.MouseUp&&(this.lastMouseDownEvent=null),this.mousePos={x:i.x||0,y:i.y||0,id:i.id,debugData:i}):(i.type===A.TouchStart&&(this.tailPositions.length=0),this.moveAndHover(i.x||0,i.y||0,i.id,n,i),i.type===A.Click?(this.mouse.classList.remove("active"),this.mouse.offsetWidth,this.mouse.classList.add("active")):i.type===A.TouchStart?(this.mouse.offsetWidth,this.mouse.classList.add("touch-active")):i.type===A.TouchEnd?this.mouse.classList.remove("touch-active"):l.dispatchEvent(s));break;case A.TouchCancel:n?this.touchActive=!1:this.mouse.classList.remove("touch-active");break;default:l.dispatchEvent(s)}break}case E.Scroll:{if(i.id===-1)break;if(this.usingVirtualDom){const s=this.virtualDom.mirror.getNode(i.id);if(!s)return this.debugNodeNotFound(i,i.id);s.scrollData=i;break}this.applyScroll(i,n);break}case E.ViewportResize:this.emitter.emit(O.Resize,{width:i.width,height:i.height});break;case E.Input:{if(i.id===-1)break;if(this.usingVirtualDom){const s=this.virtualDom.mirror.getNode(i.id);if(!s)return this.debugNodeNotFound(i,i.id);s.inputData=i;break}this.applyInput(i);break}case E.MediaInteraction:{const s=this.usingVirtualDom?this.virtualDom.mirror.getNode(i.id):this.mirror.getNode(i.id);if(!s)return this.debugNodeNotFound(i,i.id);const l=s,{events:c}=this.service.state.context;this.mediaManager.mediaMutation({target:l,timeOffset:e.timestamp-c[0].timestamp,mutation:i});break}case E.StyleSheetRule:case E.StyleDeclaration:{this.usingVirtualDom?i.styleId?this.constructedStyleMutations.push(i):i.id&&((o=this.virtualDom.mirror.getNode(i.id))==null||o.rules.push(i)):this.applyStyleSheetMutation(i);break}case E.CanvasMutation:{if(!this.config.UNSAFE_replayCanvas)return;if(this.usingVirtualDom){const s=this.virtualDom.mirror.getNode(i.id);if(!s)return this.debugNodeNotFound(i,i.id);s.canvasMutations.push({event:e,mutation:i})}else{const s=this.mirror.getNode(i.id);if(!s)return this.debugNodeNotFound(i,i.id);Pt({event:e,mutation:i,target:s,imageMap:this.imageMap,canvasEventMap:this.canvasEventMap,errorHandler:this.warnCanvasMutationFailed.bind(this)})}break}case E.Font:{try{const s=new FontFace(i.family,i.buffer?new Uint8Array(JSON.parse(i.fontSource)):i.fontSource,i.descriptors);(a=this.iframe.contentDocument)==null||a.fonts.add(s)}catch(s){this.warn(s)}break}case E.Selection:{if(n){this.lastSelectionData=i;break}this.applySelection(i);break}case E.AdoptedStyleSheet:{this.usingVirtualDom?this.adoptedStyleSheets.push(i):this.applyAdoptedStyleSheet(i);break}}}applyMutation(e,n){if(this.config.useVirtualDom&&!this.usingVirtualDom&&n&&(this.usingVirtualDom=!0,Es(this.iframe.contentDocument,this.mirror,this.virtualDom),Object.keys(this.legacy_missingNodeRetryMap).length))for(const c in this.legacy_missingNodeRetryMap)try{const u=this.legacy_missingNodeRetryMap[c],d=Xn(u.node,this.virtualDom,this.mirror);d&&(u.node=d)}catch(u){this.warn(u)}const r=this.usingVirtualDom?this.virtualDom.mirror:this.mirror;e.removes=e.removes.filter(c=>r.getNode(c.id)?!0:(this.warnNodeNotFound(e,c.id),!1)),e.removes.forEach(c=>{var u;const d=r.getNode(c.id);if(!d)return;let h=r.getNode(c.parentId);if(!h)return this.warnNodeNotFound(e,c.parentId);if(c.isShadow&&me(h)&&(h=h.shadowRoot),r.removeNodeFromMap(d),h)try{h.removeChild(d),this.usingVirtualDom&&d.nodeName==="#text"&&h.nodeName==="STYLE"&&((u=h.rules)==null?void 0:u.length)>0&&(h.rules=[])}catch(m){if(m instanceof DOMException)this.warn("parent could not remove child in mutation",h,d,e);else throw m}});const o=lt({},this.legacy_missingNodeRetryMap),a=[],i=c=>{let u=null;return c.nextId&&(u=r.getNode(c.nextId)),c.nextId!==null&&c.nextId!==void 0&&c.nextId!==-1&&!u},s=c=>{var u,d;if(!this.iframe.contentDocument)return this.warn("Looks like your replayer has been destroyed.");let h=r.getNode(c.parentId);if(!h)return c.node.type===T.Document?this.newDocumentQueue.push(c):a.push(c);c.node.isShadow&&(me(h)||h.attachShadow({mode:"open"}),h=h.shadowRoot);let m=null,y=null;if(c.previousId&&(m=r.getNode(c.previousId)),c.nextId&&(y=r.getNode(c.nextId)),i(c))return a.push(c);if(c.node.rootId&&!r.getNode(c.node.rootId))return;const p=c.node.rootId?r.getNode(c.node.rootId):this.usingVirtualDom?this.virtualDom:this.iframe.contentDocument;if(De(h,r)){this.attachDocumentToIframe(c,h);return}const v=(g,w)=>{if(!this.usingVirtualDom)for(const I of this.config.plugins||[])I.onBuild&&I.onBuild(g,{id:w,replayer:this})},f=Ue(c.node,{doc:p,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache,afterAppend:v});if(c.previousId===-1||c.nextId===-1){o[c.node.id]={node:f,mutation:c};return}const S=r.getMeta(h);if(S&&S.type===T.Element&&S.tagName==="textarea"&&c.node.type===T.Text){const g=Array.isArray(h.childNodes)?h.childNodes:Array.from(h.childNodes);for(const w of g)w.nodeType===h.TEXT_NODE&&h.removeChild(w)}else if(S?.type===T.Document){const g=h;c.node.type===T.DocumentType&&((u=g.childNodes[0])==null?void 0:u.nodeType)===Node.DOCUMENT_TYPE_NODE&&g.removeChild(g.childNodes[0]),f.nodeName==="HTML"&&g.documentElement&&g.removeChild(g.documentElement)}if(m&&m.nextSibling&&m.nextSibling.parentNode?h.insertBefore(f,m.nextSibling):y&&y.parentNode?h.contains(y)?h.insertBefore(f,y):h.insertBefore(f,null):h.appendChild(f),v(f,c.node.id),this.usingVirtualDom&&f.nodeName==="#text"&&h.nodeName==="STYLE"&&((d=h.rules)==null?void 0:d.length)>0&&(h.rules=[]),De(f,this.mirror)){const g=this.mirror.getId(f),w=this.newDocumentQueue.find(I=>I.parentId===g);w&&(this.attachDocumentToIframe(w,f),this.newDocumentQueue=this.newDocumentQueue.filter(I=>I!==w))}(c.previousId||c.nextId)&&this.legacy_resolveMissingNode(o,h,f,c)};e.adds.forEach(c=>{s(c)});const l=Date.now();for(;a.length;){const c=ln(a);if(a.length=0,Date.now()-l>500){this.warn("Timeout in the loop, please check the resolve tree data:",c);break}for(const u of c)r.getNode(u.value.parentId)?wt(u,d=>{s(d)}):this.debug("Drop resolve tree since there is no parent for the root node.",u)}Object.keys(o).length&&Object.assign(this.legacy_missingNodeRetryMap,o),cn(e.texts).forEach(c=>{var u;const d=r.getNode(c.id);if(!d)return e.removes.find(h=>h.id===c.id)?void 0:this.warnNodeNotFound(e,c.id);if(d.textContent=c.value,this.usingVirtualDom){const h=d.parentNode;((u=h?.rules)==null?void 0:u.length)>0&&(h.rules=[])}}),e.attributes.forEach(c=>{var u;const d=r.getNode(c.id);if(!d)return e.removes.find(h=>h.id===c.id)?void 0:this.warnNodeNotFound(e,c.id);for(const h in c.attributes)if(typeof h=="string"){const m=c.attributes[h];if(m===null)d.removeAttribute(h);else if(typeof m=="string")try{if(h==="_cssText"&&(d.nodeName==="LINK"||d.nodeName==="STYLE"))try{const y=r.getMeta(d);Object.assign(y.attributes,c.attributes);const p=Ue(y,{doc:d.ownerDocument,mirror:r,skipChild:!0,hackCss:!0,cache:this.cache}),v=d.nextSibling,f=d.parentNode;if(p&&f){f.removeChild(d),f.insertBefore(p,v),r.replace(c.id,p);break}}catch{}if(h==="value"&&d.nodeName==="TEXTAREA"){const y=d;y.childNodes.forEach(v=>y.removeChild(v));const p=(u=d.ownerDocument)==null?void 0:u.createTextNode(m);p&&y.appendChild(p)}else d.setAttribute(h,m)}catch(y){this.warn("An error occurred may due to the checkout feature.",y)}else if(h==="style"){const y=m,p=d;for(const v in y)if(y[v]===!1)p.style.removeProperty(v);else if(y[v]instanceof Array){const f=y[v];p.style.setProperty(v,f[0],f[1])}else{const f=y[v];p.style.setProperty(v,f)}}}})}applyScroll(e,n){var r,o;const a=this.mirror.getNode(e.id);if(!a)return this.debugNodeNotFound(e,e.id);const i=this.mirror.getMeta(a);if(a===this.iframe.contentDocument)(r=this.iframe.contentWindow)==null||r.scrollTo({top:e.y,left:e.x,behavior:n?"auto":"smooth"});else if(i?.type===T.Document)(o=a.defaultView)==null||o.scrollTo({top:e.y,left:e.x,behavior:n?"auto":"smooth"});else try{a.scrollTo({top:e.y,left:e.x,behavior:n?"auto":"smooth"})}catch{}}applyInput(e){const n=this.mirror.getNode(e.id);if(!n)return this.debugNodeNotFound(e,e.id);try{n.checked=e.isChecked,n.value=e.text}catch{}}applySelection(e){try{const n=new Set,r=e.ranges.map(({start:o,startOffset:a,end:i,endOffset:s})=>{const l=this.mirror.getNode(o),c=this.mirror.getNode(i);if(!l||!c)return;const u=new Range;u.setStart(l,a),u.setEnd(c,s);const d=l.ownerDocument,h=d?.getSelection();return h&&n.add(h),{range:u,selection:h}});n.forEach(o=>o.removeAllRanges()),r.forEach(o=>{var a;return o&&((a=o.selection)==null?void 0:a.addRange(o.range))})}catch{}}applyStyleSheetMutation(e){var n;let r=null;e.styleId?r=this.styleMirror.getStyle(e.styleId):e.id&&(r=((n=this.mirror.getNode(e.id))==null?void 0:n.sheet)||null),r&&(e.source===E.StyleSheetRule?this.applyStyleSheetRule(e,r):e.source===E.StyleDeclaration&&this.applyStyleDeclaration(e,r))}applyStyleSheetRule(e,n){var r,o,a,i;if((r=e.adds)==null||r.forEach(({rule:s,index:l})=>{try{if(Array.isArray(l)){const{positions:c,index:u}=Ct(l);ke(n.cssRules,c).insertRule(s,u)}else{const c=l===void 0?void 0:Math.min(l,n.cssRules.length);n?.insertRule(s,c)}}catch{}}),(o=e.removes)==null||o.forEach(({index:s})=>{try{if(Array.isArray(s)){const{positions:l,index:c}=Ct(s);ke(n.cssRules,l).deleteRule(c||0)}else n?.deleteRule(s)}catch{}}),e.replace)try{(a=n.replace)==null||a.call(n,e.replace)}catch{}if(e.replaceSync)try{(i=n.replaceSync)==null||i.call(n,e.replaceSync)}catch{}}applyStyleDeclaration(e,n){e.set&&ke(n.rules,e.index).style.setProperty(e.set.property,e.set.value,e.set.priority),e.remove&&ke(n.rules,e.index).style.removeProperty(e.remove.property)}applyAdoptedStyleSheet(e){var n;const r=this.mirror.getNode(e.id);if(!r)return;(n=e.styles)==null||n.forEach(s=>{var l;let c=null,u=null;if(me(r)?u=((l=r.ownerDocument)==null?void 0:l.defaultView)||null:r.nodeName==="#document"&&(u=r.defaultView),!!u)try{c=new u.CSSStyleSheet,this.styleMirror.add(c,s.styleId),this.applyStyleSheetRule({source:E.StyleSheetRule,adds:s.rules},c)}catch{}});const o=10;let a=0;const i=(s,l)=>{const c=l.map(u=>this.styleMirror.getStyle(u)).filter(u=>u!==null);me(s)?s.shadowRoot.adoptedStyleSheets=c:s.nodeName==="#document"&&(s.adoptedStyleSheets=c),c.length!==l.length&&a<o&&(setTimeout(()=>i(s,l),0+100*a),a++)};i(r,e.styleIds)}legacy_resolveMissingNode(e,n,r,o){const{previousId:a,nextId:i}=o,s=a&&e[a],l=i&&e[i];if(s){const{node:c,mutation:u}=s;n.insertBefore(c,r),delete e[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(e,n,c,u)}if(l){const{node:c,mutation:u}=l;n.insertBefore(c,r.nextSibling),delete e[u.node.id],delete this.legacy_missingNodeRetryMap[u.node.id],(u.previousId||u.nextId)&&this.legacy_resolveMissingNode(e,n,c,u)}}moveAndHover(e,n,r,o,a){const i=this.mirror.getNode(r);if(!i)return this.debugNodeNotFound(a,r);const s=Et(i,this.iframe),l=e*s.absoluteScale+s.x,c=n*s.absoluteScale+s.y;this.mouse.style.left=`${l}px`,this.mouse.style.top=`${c}px`,o||this.drawMouseTail({x:l,y:c}),this.hoverElements(i)}drawMouseTail(e){if(!this.mouseTail)return;const{lineCap:n,lineWidth:r,strokeStyle:o,duration:a}=this.config.mouseTail===!0?Wt:Object.assign({},Wt,this.config.mouseTail),i=()=>{if(!this.mouseTail)return;const s=this.mouseTail.getContext("2d");!s||!this.tailPositions.length||(s.clearRect(0,0,this.mouseTail.width,this.mouseTail.height),s.beginPath(),s.lineWidth=r,s.lineCap=n,s.strokeStyle=o,s.moveTo(this.tailPositions[0].x,this.tailPositions[0].y),this.tailPositions.forEach(l=>s.lineTo(l.x,l.y)),s.stroke())};this.tailPositions.push(e),i(),setTimeout(()=>{this.tailPositions=this.tailPositions.filter(s=>s!==e),i()},a/this.speedService.state.context.timer.speed)}hoverElements(e){var n;(n=this.lastHoveredRootNode||this.iframe.contentDocument)==null||n.querySelectorAll(".\\:hover").forEach(o=>{o.classList.remove(":hover")}),this.lastHoveredRootNode=e.getRootNode();let r=e;for(;r;)r.classList&&r.classList.add(":hover"),r=r.parentElement}isUserInteraction(e){return e.type!==C.IncrementalSnapshot?!1:e.data.source>E.Mutation&&e.data.source<=E.Input}backToNormal(){this.nextUserInteractionEvent=null,!this.speedService.state.matches("normal")&&(this.speedService.send({type:"BACK_TO_NORMAL"}),this.emitter.emit(O.SkipEnd,{speed:this.speedService.state.context.normalSpeed}))}warnNodeNotFound(e,n){this.warn(`Node with id '${n}' not found. `,e)}warnCanvasMutationFailed(e,n){this.warn("Has error on canvas update",n,"canvas mutation:",e)}debugNodeNotFound(e,n){this.debug(`Node with id '${n}' not found. `,e)}warn(...e){!this.config.showWarning||this.config.logger.warn(mr,...e)}debug(...e){!this.config.showDebug||this.config.logger.log(mr,...e)}}const{addCustomEvent:ti}=we,{freezePage:ni}=we;return G.EventType=C,G.IncrementalSource=E,G.MouseInteractions=A,G.Replayer=ei,G.ReplayerEvents=O,G.addCustomEvent=ti,G.canvasMutation=Pt,G.freezePage=ni,G.record=we,G.utils=Zr,Object.defineProperty(G,"__esModule",{value:!0}),G}({});
//# sourceMappingURL=rrweb.min.js.map
